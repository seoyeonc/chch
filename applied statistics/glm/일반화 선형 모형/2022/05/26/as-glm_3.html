<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>응용통계학 (13주차) 5월 26일 | Seoyeon Choi</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="응용통계학 (13주차) 5월 26일" />
<meta name="author" content="최서연" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="GLM, 일반화선형모형 3번째" />
<meta property="og:description" content="GLM, 일반화선형모형 3번째" />
<link rel="canonical" href="https://seoyeonc.github.io/chch/applied%20statistics/glm/%EC%9D%BC%EB%B0%98%ED%99%94%20%EC%84%A0%ED%98%95%20%EB%AA%A8%ED%98%95/2022/05/26/as-glm_3.html" />
<meta property="og:url" content="https://seoyeonc.github.io/chch/applied%20statistics/glm/%EC%9D%BC%EB%B0%98%ED%99%94%20%EC%84%A0%ED%98%95%20%EB%AA%A8%ED%98%95/2022/05/26/as-glm_3.html" />
<meta property="og:site_name" content="Seoyeon Choi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-26T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"GLM, 일반화선형모형 3번째","url":"https://seoyeonc.github.io/chch/applied%20statistics/glm/%EC%9D%BC%EB%B0%98%ED%99%94%20%EC%84%A0%ED%98%95%20%EB%AA%A8%ED%98%95/2022/05/26/as-glm_3.html","@type":"BlogPosting","headline":"응용통계학 (13주차) 5월 26일","dateModified":"2022-05-26T00:00:00-05:00","datePublished":"2022-05-26T00:00:00-05:00","author":{"@type":"Person","name":"최서연"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seoyeonc.github.io/chch/applied%20statistics/glm/%EC%9D%BC%EB%B0%98%ED%99%94%20%EC%84%A0%ED%98%95%20%EB%AA%A8%ED%98%95/2022/05/26/as-glm_3.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/chch/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://seoyeonc.github.io/chch/feed.xml" title="Seoyeon Choi" /><link rel="shortcut icon" type="image/x-icon" href="/chch/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/chch/">Seoyeon Choi</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/chch/about/">About Me</a><a class="page-link" href="/chch/search/">Search</a><a class="page-link" href="/chch/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">응용통계학 (13주차) 5월 26일</h1><p class="page-description">GLM, 일반화선형모형 3번째</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-05-26T00:00:00-05:00" itemprop="datePublished">
        May 26, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">최서연</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/chch/categories/#Applied Statistics">Applied Statistics</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chch/categories/#GLM">GLM</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chch/categories/#일반화 선형 모형">일반화 선형 모형</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/seoyeonc/chch/tree/master/_notebooks/2022-05-26-as-glm_3.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/chch/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/seoyeonc/chch/master?filepath=_notebooks%2F2022-05-26-as-glm_3.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chch/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/seoyeonc/chch/blob/master/_notebooks/2022-05-26-as-glm_3.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chch/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#일반화선형모형-:-Generalized-linear-model-III">일반화선형모형 : Generalized linear model III </a>
<ul>
<li class="toc-entry toc-h3"><a href="#1.-GLM-definition">1. GLM definition </a>
<ul>
<li class="toc-entry toc-h4"><a href="#1.1.-Exponential-family-:-다음과-같은-분포를-따를-때-$Y$가-지수족을-따른다고-한다.">1.1. Exponential family : 다음과 같은 분포를 따를 때 $Y$가 지수족을 따른다고 한다. </a></li>
<li class="toc-entry toc-h4"><a href="#1.2.-Link-function">1.2. Link function </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#2.-Fitting-a-GLM">2. Fitting a GLM </a></li>
<li class="toc-entry toc-h3"><a href="#3.-Hypothesis-tests">3. Hypothesis tests </a></li>
<li class="toc-entry toc-h3"><a href="#4.-GLM-Diagnostics">4. GLM Diagnostics </a>
<ul>
<li class="toc-entry toc-h4"><a href="#4.1.-Residuals">4.1. Residuals </a>
<ul>
<li class="toc-entry toc-h5"><a href="#4.1.1.-Pearson-residual">4.1.1. Pearson residual </a></li>
<li class="toc-entry toc-h5"><a href="#4.1.2.-Deviance-residual">4.1.2. Deviance residual </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-05-26-as-glm_3.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="일반화선형모형-:-Generalized-linear-model-III">
<a class="anchor" href="#%EC%9D%BC%EB%B0%98%ED%99%94%EC%84%A0%ED%98%95%EB%AA%A8%ED%98%95-:-Generalized-linear-model-III" aria-hidden="true"><span class="octicon octicon-link"></span></a>일반화선형모형 : Generalized linear model III<a class="anchor-link" href="#%EC%9D%BC%EB%B0%98%ED%99%94%EC%84%A0%ED%98%95%EB%AA%A8%ED%98%95-:-Generalized-linear-model-III"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>선형모형, 로지스틱모형, count regression 등에 이르기까지 다양한 종류의 response를 (1) response 자체의 분포의 특성을 고려하여 (2) conditional mean function을 추정하기 위한 적절한 연결함수를 고려하여 모형화 및 추정을 시도하였다.</p>
<p>이러한 것들을 보다 일반화하여 앞서 다루었던 모형 및 추정법등을 포함하는 하나의 모형을 생각할 수 있는데 이를 일반화선형모형 (Generalized linear model : GLM)이라 한다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-GLM-definition">
<a class="anchor" href="#1.-GLM-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. GLM definition<a class="anchor-link" href="#1.-GLM-definition"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>GLM은 크게 두 가지 요소를 특정하는 것으로 정의된. 첫째 response의 분포로, 기본적으로 <strong>지수족 (exponential family)</strong>을 따르는 것으로 가정한다. 둘째는 link 함수로, response의 conditional <strong>mean</strong> function을 linear predictor와 어떻게 연결할 것인지이다.</p>
<ul>
<li>binary - logistic link function</li>
<li>poisson - log link function</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.1.-Exponential-family-:-다음과-같은-분포를-따를-때-$Y$가-지수족을-따른다고-한다.">
<a class="anchor" href="#1.1.-Exponential-family-:-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EC%9D%80-%EB%B6%84%ED%8F%AC%EB%A5%BC-%EB%94%B0%EB%A5%BC-%EB%95%8C-%24Y%24%EA%B0%80-%EC%A7%80%EC%88%98%EC%A1%B1%EC%9D%84-%EB%94%B0%EB%A5%B8%EB%8B%A4%EA%B3%A0-%ED%95%9C%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a>1.1. Exponential family : 다음과 같은 분포를 따를 때 $Y$가 지수족을 따른다고 한다.<a class="anchor-link" href="#1.1.-Exponential-family-:-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EC%9D%80-%EB%B6%84%ED%8F%AC%EB%A5%BC-%EB%94%B0%EB%A5%BC-%EB%95%8C-%24Y%24%EA%B0%80-%EC%A7%80%EC%88%98%EC%A1%B1%EC%9D%84-%EB%94%B0%EB%A5%B8%EB%8B%A4%EA%B3%A0-%ED%95%9C%EB%8B%A4."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
$$f(y|\theta,\phi) = exp \big[ \frac{y\theta - b(\theta)}{a(\phi)} + c(y,\theta) \big]$$

$\theta$ : canonical parameter, $\phi$: disperison parameter</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>정규분포($N(\mu, \sigma^2)$):

$$\theta = \mu, \phi = \sigma^2, a(\phi) = \phi, b(\theta) = \theta^2, c(y,\phi) = -(y^2 /\phi + log(2\pi\phi))/2$$
</li>
</ol>
<ul>
<li>$b'(\theta) = \theta = \mu$</li>
<li>$f(\theta) = b'(\theta) = \theta$</li>
<li>$f^{-1}(\theta) = \theta = g(\theta)$ : 정준 연결 함수 $\to$ 안 쓰는게 자연스런 $\theta$ function 쓰는 것!</li>
</ul>
<ol>
<li>Poisson:

$$\theta = log(\mu), \phi = 1, a(\phi) = 1, b(\theta) = exp(\theta), c(y,\phi) = -logy!$$
</li>
</ol>
<ul>
<li>$b'(\theta) = exp(\theta) = exp(log(\mu)=  \mu$</li>
<li>$ f(\theta)=  b'(\theta) = e^{\theta}$</li>
<li>$f^{-1}(\theta) = log(\theta) = g(\theta)$ : 정준 연결 함수 $\to$ $log$쓰는 게 자연스런 $\theta$ function 쓰는 법</li>
</ul>
<ol>
<li>Binomial:

$$\theta = log(\mu/(1-\mu)), b(\theta) = -nlog(1-\mu) = nlog(1+exp(\theta)), c(y,\phi) = log\begin{pmatrix} n\\ y\end{pmatrix}$$
</li>
</ol>
<ul>
<li>$\mu = P(Y=1)$</li>
<li>$b'(\theta) = \frac{exp(\theta)}{1+exp(\theta)}$</li>
<li>$f(\theta) = \frac{exp(\theta)}{1+exp(\theta)}$</li>
<li>$f^{-1} = log\frac{exp(\theta)}{1+exp(\theta)} = g(\theta)$ : 정준 연결 함수 $\to$ $logit$ 쓰는 게 자연스런 $\theta$  function 쓰는 법</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>감마 및 역감마분포도 지수족에 포함된다.</p>
<p>일반적으로 지수족을 따르는 경우 response의 평균과 분산이 어떻게 표현되는지는 다음으로부터 이끌어 낼 수 있다.</p>
<p>먼저 log-likelihood for a sigle $y$는 다음과 같이 주어지므로:</p>
<p>
$$l(\theta) = (y\theta)-b(\theta))/a(\phi) + c(y,\phi)$$
</p>
<p>이 함수의 일차/이차 미분은 다음과 같이 계산된다.</p>
<p>
$$l'(\theta) = (y-b'(\theta))/a(\phi), l''(\theta) = -b''(\theta)/a(\phi)$$
</p>
<ul>
<li>분자가 0이 되면 0이 되므로 $y=b'(\theta)$만 만족하면 된다. </li>
</ul>
<p>그러면 score function 이 mean이 0이라는 성질과 이차미분에 대한 성질로부터 ;</p>
<p>$El'(\theta) = 0$과 $El''(\theta) = -E[l'(\theta)^2]$을 얻고 이로부터 다음 식을 얻을 수 있다.</p>
<p>
$$E(Y) = \mu b'(\theta), Var(Y) = b''(\theta)a(\phi)$$
</p>
<ul>
<li>$E(Y)$에서는 $\theta$만 역할을 하지만, $Var(Y)$에서는 $\theta$랑 $\phi$ 모두 역할이 있다.</li>
</ul>
<p>위로부터 평균은 $θ$이 함수임을 알 수 있다. 또한 분산은 $θ$와 $ϕ$의 함수의 곱 형태로 주어진다. 여기서 $V(μ)=b′′(θ)/w$를 variance function이라 지칭하는데 이는 분산이 평균과 어떻게 연결되는지를 기술해주는 것으로 이해할 수 있다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.2.-Link-function">
<a class="anchor" href="#1.2.-Link-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.2. Link function<a class="anchor-link" href="#1.2.-Link-function"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
$$\eta = g(\mu) = \beta_0 + \beta_1 x_1 + \dots + \beta_p x_p = x^\top \beta$$
</p>
<ul>
<li>$g(\mu) = \theta$</li>
<li>$\to$ $g(b'(\theta) = \theta$</li>
<li>$\to$ $(g \bullet b')(\theta) = \theta$</li>
<li>$\to$ $g(\theta) = b'^{-1}(\theta)$<ul>
<li>
<ol>
<li>분포가 정해진 후</li>
</ol>
</li>
<li>
<ol>
<li>link function 이 정해진다.</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>$E(Y) = \mu$ 이다. 원론적으로는 어떤 monotone continuous and differentiable function도 연결함수의 역할을 할 수 있으나 GLM에서 보통 선택하는 연결함수에는 몇 가지 유용한 성질을 가지게 된다. 이를 <strong>정준연결함수(canonical link function)</strong>이라 한다.</p>
<p>정준연결함수 $g$는 $η=g(μ)=θ$를 만족하는 함수를 말한다. 이는 곧 $g(b′(θ))=θ$를 함의하게 된다. Poisson 분포에서는 log함수가 Binomial 분포에서는 logit 함수가 정규분포에서는 항등함수가 정준연결함수가 됨이 알려져 있다.</p>
<p>이러한 정준연결함수는 수학적으로 또한 추정량 계산상에 있어서 여러가지 장점이 있어 널리 쓰인다.</p>
<ul>
<li>적어도 이론적으로 추정량 찾는데 많은 장점이 있다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Fitting-a-GLM">
<a class="anchor" href="#2.-Fitting-a-GLM" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Fitting a GLM<a class="anchor-link" href="#2.-Fitting-a-GLM"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>최대가능도추정법이 GLM의 추정에서 기본적으로 쓰인다. 분포가 정규분포일 때를 제외하면 가능도방정식의 해가 명시적으로 표현되지 않기 때문에 수치적인 접근법을 이용해야 한다. 보통 Newton-Raphson에 근거한 방법들을 이용하게 된다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Hypothesis-tests">
<a class="anchor" href="#3.-Hypothesis-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Hypothesis tests<a class="anchor-link" href="#3.-Hypothesis-tests"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Null model : 가장 간단한 모형으로 설명변수가 하나도 포함되지 않은 모형</li>
<li>Full (Saturated) model :가장 복잡하고 큰 모형으로 $n$개의 관측치에 대하여 $n$개의 parameter를 사용. 이 경우 $\hat{μ}=y$가 만족되게 된다.</li>
</ul>
<p>앞서 언급했듯이 현재 모형이 데이터를 얼마나 잘 적합하는지를 측정하고 할 때, 현재 모형을 full model과 비교하게 된다. 즉, 다음과 같은 두 모형의 차이를 생각한다.</p>
<p>
$$1[log(y,\phi|y) - log(\hat{\mu},\phi|y)]$$
</p>
<ul>
<li>적합도가 좋으면 이 값이 작아진다.</li>
</ul>
<p>이를 deviance라 하고 다음과 같이 쓴다.</p>
<p>
$$D(y,\hat{\mu})$$
</p>
<ul>
<li>$\sqrt{d_i}$ : Deviance type residual</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead>
<tr>
<th>GLM</th>
<th>Deviance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gaussian_Normal</td>
<td>$\sum_i (y_i - \hat{\mu}_i)^2$ $\approx$ SSE</td>
</tr>
<tr>
<td>Poisson</td>
<td>$2\sum_i[y_i log(y_i/\hat{\mu}-i) - (y_i - \hat{\mu}_i)]$ $ =2 생략하고 \sum d_i = \sum (\sqrt{d_i})^2$,제곱하는 개념으로 보고 root씌운 것을 잔차라고 놓는다. $\sqrt{d_i}$는 양수/음수 가능</td>
</tr>
<tr>
<td>Binomial</td>
<td>$2\sum_i [y_i(log(y_i/\hat{\mu}_i) + (m-y_i)log((m-y_i)/(m-\hat{\mu}_i))]$</td>
</tr>
<tr>
<td>Gamma</td>
<td>$2\sum_i[-log(y_i/\hat{\mu}_i) + (y_i - \hat{\mu}_i)/\hat{\mu}_i]]$</td>
</tr>
<tr>
<td>Inverse Gaussian</td>
<td>$\sum_i (y_i - \hat{\mu}_i)^2/(\hat{\mu}^{2}_{i} y_i)$</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이는 선형모형에거 SSE를 GLM 하에서 일반화시킨 것으로 간주할 수 있다.</p>
<p>적합도를 측정하는 또 다른 방법 중 하나는 Pearson’s $X^2$ 통계량을 고려하는 것이다.</p>
<p>
$$X^2 = \sum_i \frac{(y_i - \hat{\mu_i})^2}{V(\hat{\mu}_i)}$$
</p>
<ul>
<li>일종의 잔차 표준화이다.</li>
<li>표준화 $\big(\frac{X-\mu}{\sigma}\big)^2 = \frac{(X-\mu)^2}{\sigma} \sim \chi^2_{(1)}, Z \sim \chi^2_{(1)}$</li>
<li>값이 클 수록 적합도가 안 좋다는 뜻, 값이 작을수록 적합도가 좋다는 뜻</li>
</ul>
<p>더 큰 모형을 $Ω$ 작은 모형을 $ω$라 할 때, scaled deviance의 차이 $D_ω−D_Ω$는 점근적으로 $χ^2$ 분포를library(faraway) 따르게 된다. 이 때 자유도는 두 모형의 모수 개수의 차이이다.</p>
<ul>
<li>적합도 평가 뿐만이 아니라 차이의 카이제곱분포를 따름을 보이고 유의성 평가까지 할 것.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">faraway</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>conc는 살충제 농도이고,</li>
<li>binomial로 놓은 이유는 생존을 이진수로 나타내니까</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">data</span><span class="p">(</span><span class="n">bliss</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s">"faraway"</span><span class="p">)</span>
<span class="n">modl</span> <span class="o">&lt;-</span> <span class="nf">glm</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">dead</span><span class="p">,</span><span class="n">alive</span><span class="p">)</span> <span class="o">~</span> <span class="n">conc</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">,</span> <span class="n">bliss</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>
Call:
glm(formula = cbind(dead, alive) ~ conc, family = binomial, data = bliss)

Deviance Residuals: 
      1        2        3        4        5  
-0.4510   0.3597   0.0000   0.0643  -0.2045  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -2.3238     0.4179  -5.561 2.69e-08 ***
conc          1.1619     0.1814   6.405 1.51e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 64.76327  on 4  degrees of freedom
Residual deviance:  0.37875  on 3  degrees of freedom
AIC: 20.854

Number of Fisher Scoring iterations: 4
</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>conc의 estimate가 양수이다. 1.1619</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="m">1</span><span class="o">-</span><span class="nf">pchisq</span><span class="p">(</span><span class="nf">deviance</span><span class="p">(</span><span class="n">modl</span><span class="p">),</span><span class="nf">df.residual</span><span class="p">(</span><span class="n">modl</span><span class="p">))</span>  <span class="c1"># test for goodness of fit</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
0.944596758540894
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>함수 2개 쓰는 2차 함수 사용</li>
<li>test='chi' 없어도 된대</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">modl2</span> <span class="o">&lt;-</span> <span class="nf">glm</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">dead</span><span class="p">,</span><span class="n">alive</span><span class="p">)</span> <span class="o">~</span> <span class="n">conc</span><span class="o">+</span><span class="nf">I</span><span class="p">(</span><span class="n">conc</span><span class="o">^</span><span class="m">2</span><span class="p">),</span> <span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">,</span> <span class="n">bliss</span><span class="p">)</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">modl</span><span class="p">,</span><span class="n">modl2</span><span class="p">,</span><span class="n">test</span><span class="o">=</span><span class="s">"Chi"</span><span class="p">)</span>   <span class="c1"># test for additional parameter</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table class="dataframe">
<caption>A anova: 2 × 5</caption>
<thead>
	<tr>
<th></th>
<th scope="col">Resid. Df</th>
<th scope="col">Resid. Dev</th>
<th scope="col">Df</th>
<th scope="col">Deviance</th>
<th scope="col">Pr(&gt;Chi)</th>
</tr>
	<tr>
<th></th>
<th scope="col">&lt;dbl&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
	<tr>
<th scope="row">1</th>
<td>3</td>
<td>0.3787483</td>
<td>NA</td>
<td>       NA</td>
<td>       NA</td>
</tr>
	<tr>
<th scope="row">2</th>
<td>2</td>
<td>0.1954940</td>
<td> 1</td>
<td>0.1832542</td>
<td>0.6685914</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">anova</span><span class="p">(</span><span class="n">modl2</span><span class="p">,</span><span class="n">test</span><span class="o">=</span><span class="s">"Chi"</span><span class="p">)</span>        <span class="c1"># test for additional parameter</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table class="dataframe">
<caption>A anova: 3 × 5</caption>
<thead>
	<tr>
<th></th>
<th scope="col">Df</th>
<th scope="col">Deviance</th>
<th scope="col">Resid. Df</th>
<th scope="col">Resid. Dev</th>
<th scope="col">Pr(&gt;Chi)</th>
</tr>
	<tr>
<th></th>
<th scope="col">&lt;int&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
<th scope="col">&lt;int&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
<th scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
	<tr>
<th scope="row">NULL</th>
<td>NA</td>
<td>        NA</td>
<td>4</td>
<td>64.7632662</td>
<td>          NA</td>
</tr>
	<tr>
<th scope="row">conc</th>
<td> 1</td>
<td>64.3845179</td>
<td>3</td>
<td> 0.3787483</td>
<td>1.023593e-15</td>
</tr>
	<tr>
<th scope="row">I(conc^2)</th>
<td> 1</td>
<td> 0.1832542</td>
<td>2</td>
<td> 0.1954940</td>
<td>6.685914e-01</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>0.6685914로 유의하지 않음.</li>
<li>유의미하게 적합도를 높이지 않는다.</li>
<li>굳이 모델 2로 확장하지 않아도 된다.</li>
<li>모델 2가 안 좋은 모델은 아님</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-GLM-Diagnostics">
<a class="anchor" href="#4.-GLM-Diagnostics" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. GLM Diagnostics<a class="anchor-link" href="#4.-GLM-Diagnostics"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>선형모형에서 잔차를 중심으로 모형진단을 했듯이 GLM에서도 비슷한 절차가 필요할 수 있다.</p>
<ul>
<li>이 모형 진단은 중요도가 떨어지긴 한다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="4.1.-Residuals">
<a class="anchor" href="#4.1.-Residuals" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1. Residuals<a class="anchor-link" href="#4.1.-Residuals"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>잔차는 response 상에서 관측치와 모형에 의한 적합치 사이의 차이를 의미한다. 선형모형에서 정의했던 것을 확장하여 잔차를 GLM에서 정의하기도 한다.</p>
<ul>
<li>사실 로지스틱하고 진단을 잘 안 하긴 하다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="4.1.1.-Pearson-residual">
<a class="anchor" href="#4.1.1.-Pearson-residual" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1.1. Pearson residual<a class="anchor-link" href="#4.1.1.-Pearson-residual"> </a>
</h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>선형모형에서의 표준화잔차와 유사한 개념으로 이해할 수 있다.</p>
<p>
$$r_P = \frac{y-\hat{\mu}}{\sqrt{V(\mu})}$$
</p>
<ul>
<li>피어슨 타입 잔차</li>
</ul>
<p>여기서 $V(\mu)=b''(\theta)$이다. 또한 $\sum r^{2}_{P}=X^2$가 된다.</p>
<ul>
<li>$y = X\beta' + \epsilon$에서 $\epsilon \sim N(,)$임을 확닉하나? $|to$ $y$랑 분포 맞추자.</li>
<li>연속 $y \to \sqrt{y}. log y$</li>
<li>이진 $y \to $ ? $\epsilon$(Bernoulli) or $\epsilon$(Binary)</li>
<li>count $y \to $ ? $\epsilon$(poisson)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="4.1.2.-Deviance-residual">
<a class="anchor" href="#4.1.2.-Deviance-residual" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1.2. Deviance residual<a class="anchor-link" href="#4.1.2.-Deviance-residual"> </a>
</h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Deviance로부터 정의되는 타입의 잔차이다.</p>
<ul>
<li>Deviance는 SSE의 일반화 버전</li>
<li>$\sum^{n}_{i=1} e^{2}_{i}$ 잔차제곱합 일반화 = 총합의 개념 $y-\hat{\mu}&gt;0$</li>
</ul>
<p>
$$sum r^{2}_{D} = Deviance = \sum d_i$$
</p>
<ul>
<li>$d_i$를 Deviance의 제곱이라 보자</li>
</ul>
<p>따라서</p>
<p>
$$r_D = sign(y - \hat{\mu})\sqrt{d_i}$$
</p>
<ul>
<li>$y&gt;\hat{\mu} \to$ residual &gt;0</li>
<li>$y&lt;\hat{\mu} \to$ residual &lt;0</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">residuals</span><span class="p">(</span><span class="n">modl</span><span class="p">)</span>     <span class="c1"># deviance residual</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style>&lt;dl class=dl-inline&gt;<dt>1</dt>
<dd>-0.451015104787619</dd>
<dt>2</dt>
<dd>0.359696068619502</dd>
<dt>3</dt>
<dd>0</dd>
<dt>4</dt>
<dd>0.0643023497984944</dd>
<dt>5</dt>
<dd>-0.204493466553935</dd>&lt;/dl&gt;

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">residuals</span><span class="p">(</span><span class="n">modl</span><span class="p">,</span><span class="s">"pearson"</span><span class="p">)</span> <span class="c1"># Pearson residual</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style>&lt;dl class=dl-inline&gt;<dt>1</dt>
<dd>-0.432523418155746</dd>
<dt>2</dt>
<dd>0.364372922057795</dd>
<dt>3</dt>
<dd>-3.64856516669287e-15</dd>
<dt>4</dt>
<dd>0.0641468727776392</dd>
<dt>5</dt>
<dd>-0.208106840520636</dd>&lt;/dl&gt;

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">residuals</span><span class="p">(</span><span class="n">modl</span><span class="p">,</span><span class="s">"response"</span><span class="p">)</span> <span class="c1"># response residual</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style>&lt;dl class=dl-inline&gt;<dt>1</dt>
<dd>-0.0225050988094856</dd>
<dt>2</dt>
<dd>0.0283435309523039</dd>
<dt>3</dt>
<dd>-3.33066907387547e-16</dd>
<dt>4</dt>
<dd>0.00498980238102908</dd>
<dt>5</dt>
<dd>-0.010828234523848</dd>&lt;/dl&gt;

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">bliss</span><span class="o">$</span><span class="n">dead</span><span class="o">/</span><span class="m">30</span> <span class="o">-</span> <span class="nf">fitted</span><span class="p">(</span><span class="n">modl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style>&lt;dl class=dl-inline&gt;<dt>1</dt>
<dd>-0.0225050988094856</dd>
<dt>2</dt>
<dd>0.0283435309523039</dd>
<dt>3</dt>
<dd>-3.33066907387547e-16</dd>
<dt>4</dt>
<dd>0.00498980238102908</dd>
<dt>5</dt>
<dd>-0.010828234523848</dd>&lt;/dl&gt;

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>QQ plot은 선형모형에서 정규성을 확인하기 위해 사용하는 시각화 방법 중 하나였다. GLM에서는 분포 자체를 확인하기 위한 목적보다는 <strong>이상점의 존재를 확인하기 위한 목적으로 보통 활용</strong>된다.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/chch/applied%20statistics/glm/%EC%9D%BC%EB%B0%98%ED%99%94%20%EC%84%A0%ED%98%95%20%EB%AA%A8%ED%98%95/2022/05/26/as-glm_3.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/chch/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/chch/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/chch/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/seoyeonc" target="_blank" title="seoyeonc"><svg class="svg-icon grey"><use xlink:href="/chch/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
