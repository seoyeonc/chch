<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>빅데이터 분석 기말고사 | Seoyeon Choi</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="빅데이터 분석 기말고사" />
<meta name="author" content="최서연" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://seoyeonc.github.io/chch/big%20data%20analysis/2022/01/23/bd-final.html" />
<meta property="og:url" content="https://seoyeonc.github.io/chch/big%20data%20analysis/2022/01/23/bd-final.html" />
<meta property="og:site_name" content="Seoyeon Choi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-23T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"An easy to use blogging platform with support for Jupyter Notebooks.","url":"https://seoyeonc.github.io/chch/big%20data%20analysis/2022/01/23/bd-final.html","@type":"BlogPosting","headline":"빅데이터 분석 기말고사","dateModified":"2022-01-23T00:00:00-06:00","datePublished":"2022-01-23T00:00:00-06:00","author":{"@type":"Person","name":"최서연"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seoyeonc.github.io/chch/big%20data%20analysis/2022/01/23/bd-final.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/chch/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://seoyeonc.github.io/chch/feed.xml" title="Seoyeon Choi" /><link rel="shortcut icon" type="image/x-icon" href="/chch/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/chch/">Seoyeon Choi</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/chch/about/">About Me</a><a class="page-link" href="/chch/search/">Search</a><a class="page-link" href="/chch/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">빅데이터 분석 기말고사</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-01-23T00:00:00-06:00" itemprop="datePublished">
        Jan 23, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">최서연</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      13 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/chch/categories/#Big Data Analysis">Big Data Analysis</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="##1.-체인룰과-역전파기법">#1. 체인룰과 역전파기법 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#(1)-파이토치를-이용하여-순전파를-계산하라.-즉-${\bf-u}$를-계산하라.">(1) 파이토치를 이용하여 순전파를 계산하라. 즉 ${\bf u}$를 계산하라. </a></li>
<li class="toc-entry toc-h4"><a href="#(2)-파이토치를-이용하여-오차를-계산하라.-즉-${\bf-v}$를-계산하라.">(2) 파이토치를 이용하여 오차를 계산하라. 즉 ${\bf v}$를 계산하라. </a></li>
<li class="toc-entry toc-h4"><a href="#(3)-파이토치를-이용하여-오차제곱합을-계산하라.-즉-$loss={\bf-v}^\top-{\bf-v}$를-계산하라.">(3) 파이토치를 이용하여 오차제곱합을 계산하라. 즉 $loss={\bf v}^\top {\bf v}$를 계산하라. </a></li>
<li class="toc-entry toc-h4"><a href="#(4)-$\frac{\partial}{\partial-{\bf-v}}-loss$-를-해석적으로-계산하라(=이론적인-값을-계산하라).-파이토치를-이용하여-검증하라.">(4) $\frac{\partial}{\partial {\bf v}} loss$ 를 해석적으로 계산하라(=이론적인 값을 계산하라). 파이토치를 이용하여 검증하라. </a></li>
<li class="toc-entry toc-h4"><a href="#(5)$\frac{\partial-}{\partial-{\bf-u}}{\bf-v}^\top$와-$\frac{\partial-}{\partial-{\bf-W}}{\bf-u}^\top$의-값을-해석적으로-계산하라.-(파이토치를-이용한-검증은-불필요)">(5)$\frac{\partial }{\partial {\bf u}}{\bf v}^\top$와 $\frac{\partial }{\partial {\bf W}}{\bf u}^\top$의 값을 해석적으로 계산하라. (파이토치를 이용한 검증은 불필요) </a></li>
<li class="toc-entry toc-h4"><a href="#(6)-(4)~(5)의-결과와-체인룰을-이용하여-$\frac{\partial}{\partial-{\bf-W}}loss$를-계산하라.-그리고-아래의-코드를-이용하여-검증하라.">(6) (4)~(5)의 결과와 체인룰을 이용하여 $\frac{\partial}{\partial {\bf W}}loss$를 계산하라. 그리고 아래의 코드를 이용하여 검증하라. </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="##2.-음료추천">#2. 음료추천 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#(1)-user-item-matrix-생성하라.">(1) user-item matrix 생성하라. </a></li>
<li class="toc-entry toc-h4"><a href="#(2)-첫번째-유저를-평점을-조회하고-이-유저의-취향을-서술하라.-커피와-홍차중-어떤음료를-선호하는가?-따듯한-음료와-차가운-음료중-어떤-음료를-선호하는가?">(2) 첫번째 유저를 평점을 조회하고 이 유저의 취향을 서술하라. 커피와 홍차중 어떤음료를 선호하는가? 따듯한 음료와 차가운 음료중 어떤 음료를 선호하는가? </a></li>
<li class="toc-entry toc-h4"><a href="#(3)-fastai를-이용하여-추천모형을-학습하라.-(nn을-사용하지-않아도-무방하다.)">(3) fastai를 이용하여 추천모형을 학습하라. (nn을 사용하지 않아도 무방하다.) </a></li>
<li class="toc-entry toc-h4"><a href="#(4)-(3)의-추천시스템을-이용하여-모든-음료(총40개)에-대하여-144번-유저의-fitted-rating-을-구하라.-144번-유저는-어떤-취향인가?">(4) (3)의 추천시스템을 이용하여 모든 음료(총40개)에 대하여 144번 유저의 fitted rating 을 구하라. 144번 유저는 어떤 취향인가? </a></li>
<li class="toc-entry toc-h4"><a href="#(5)-차가운커피1에-대한-모든유저(총200명)의-fitted-rating을-구하라.-몇번부터-몇번까지의-유저가-차가운-커피를-선호하는가?">(5) 차가운커피1에 대한 모든유저(총200명)의 fitted rating을 구하라. 몇번부터 몇번까지의 유저가 차가운 커피를 선호하는가? </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="##3.-영화추천">#3. 영화추천 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#(1)-fastai를-이용하여-추천모형을-학습하라.-(nn을-사용하지-않아도-무방하다.)">(1) fastai를 이용하여 추천모형을 학습하라. (nn을 사용하지 않아도 무방하다.) </a></li>
<li class="toc-entry toc-h4"><a href="#(2)-아래의-영화들에-대한-30번유저의-fitted-rating을-구하라.">(2) 아래의 영화들에 대한 30번유저의 fitted rating을 구하라. </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="##4.-다음을-읽고-물음에-답하라.-(O/X로-답할것)">#4. 다음을 읽고 물음에 답하라. (O/X로 답할것) </a>
<ul>
<li class="toc-entry toc-h4"><a href="#(1)-학습이-진행됨에-따라-training-loss는-줄어들지만-validation-loss가-증가하는-현상을-기울기소실문제라고-한다.">(1) 학습이 진행됨에 따라 training loss는 줄어들지만 validation loss가 증가하는 현상을 기울기소실문제라고 한다. </a></li>
<li class="toc-entry toc-h4"><a href="#(2)-배치정규화는-기울기소실문제를-해결하는-방법-중-하나이다.">(2) 배치정규화는 기울기소실문제를 해결하는 방법 중 하나이다. </a></li>
<li class="toc-entry toc-h4"><a href="#(3)-기울기소실은-얕은신경망보다-깊은신경망에서-자주-발생한다.">(3) 기울기소실은 얕은신경망보다 깊은신경망에서 자주 발생한다. </a></li>
<li class="toc-entry toc-h4"><a href="#(4)-역전파기법은-과적합을-방지하는-테크닉중-하나이다.">(4) 역전파기법은 과적합을 방지하는 테크닉중 하나이다. </a></li>
<li class="toc-entry toc-h4"><a href="#(5)-순전파만-계산하고-싶을-경우-GPU메모리에-각-층의-계산결과를-저장할-필요가-없다.">(5) 순전파만 계산하고 싶을 경우 GPU메모리에 각 층의 계산결과를 저장할 필요가 없다. </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-01-23-bd-final.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="#1.-체인룰과-역전파기법">
<a class="anchor" href="##1.-%EC%B2%B4%EC%9D%B8%EB%A3%B0%EA%B3%BC-%EC%97%AD%EC%A0%84%ED%8C%8C%EA%B8%B0%EB%B2%95" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>#1</code>. 체인룰과 역전파기법<a class="anchor-link" href="##1.-%EC%B2%B4%EC%9D%B8%EB%A3%B0%EA%B3%BC-%EC%97%AD%EC%A0%84%ED%8C%8C%EA%B8%B0%EB%B2%95"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>주어진 자료가 아래와 같다고 하자.</p>
<ul>
<li>
<p>${\bf X} = \begin{bmatrix} 1 &amp; 2.1 \\ 1 &amp; 3.0 \end{bmatrix}$</p>
</li>
<li>
<p>${\bf y} = \begin{bmatrix} 3.0 \\ 5.0 \end{bmatrix}$</p>
</li>
</ul>
<p>손실함수의 정의가 아래와 같다고 하자.</p>
<p>
$$loss={\bf v}^\top {\bf v}$$
</p>
<p>이때 ${\bf v}= {\bf y}-{\bf u}$ 이고 ${\bf u}= {\bf X}{\bf W}$ 이다. ${\bf W} =\begin{bmatrix} 0.5 \\ 0.6 \end{bmatrix}$ 지점에서의 $\frac{\partial}{\partial {\bf W}}loss$를 역전파 기법을 이용하여 구하고 파이토치의 backward()를 이용하여 검증하라. 즉 (1)-(6)을 계산하라.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(1)-파이토치를-이용하여-순전파를-계산하라.-즉-${\bf-u}$를-계산하라.">
<a class="anchor" href="#(1)-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%88%9C%EC%A0%84%ED%8C%8C%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EC%A6%89-%24%7B%5Cbf-u%7D%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(1)</code> 파이토치를 이용하여 순전파를 계산하라. 즉 ${\bf u}$를 계산하라.<a class="anchor-link" href="#(1)-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%88%9C%EC%A0%84%ED%8C%8C%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EC%A6%89-%24%7B%5Cbf-u%7D%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ones</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">3.0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ones</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">])</span> 
<span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@W</span> 
<span class="n">u</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([1.7600, 2.3000])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(2)-파이토치를-이용하여-오차를-계산하라.-즉-${\bf-v}$를-계산하라.">
<a class="anchor" href="#(2)-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%98%A4%EC%B0%A8%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EC%A6%89-%24%7B%5Cbf-v%7D%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(2)</code> 파이토치를 이용하여 오차를 계산하라. 즉 ${\bf v}$를 계산하라.<a class="anchor-link" href="#(2)-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%98%A4%EC%B0%A8%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EC%A6%89-%24%7B%5Cbf-v%7D%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span><span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">u</span>
<span class="n">v</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([1.2400, 2.7000])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(3)-파이토치를-이용하여-오차제곱합을-계산하라.-즉-$loss={\bf-v}^\top-{\bf-v}$를-계산하라.">
<a class="anchor" href="#(3)-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%98%A4%EC%B0%A8%EC%A0%9C%EA%B3%B1%ED%95%A9%EC%9D%84-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EC%A6%89-%24loss=%7B%5Cbf-v%7D%5E%5Ctop-%7B%5Cbf-v%7D%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(3)</code> 파이토치를 이용하여 오차제곱합을 계산하라. 즉 $loss={\bf v}^\top {\bf v}$를 계산하라.<a class="anchor-link" href="#(3)-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%98%A4%EC%B0%A8%EC%A0%9C%EA%B3%B1%ED%95%A9%EC%9D%84-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EC%A6%89-%24loss=%7B%5Cbf-v%7D%5E%5Ctop-%7B%5Cbf-v%7D%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="nd">@v</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(8.8276)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(4)-$\frac{\partial}{\partial-{\bf-v}}-loss$-를-해석적으로-계산하라(=이론적인-값을-계산하라).-파이토치를-이용하여-검증하라.">
<a class="anchor" href="#(4)-%24%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial-%7B%5Cbf-v%7D%7D-loss%24-%EB%A5%BC-%ED%95%B4%EC%84%9D%EC%A0%81%EC%9C%BC%EB%A1%9C-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC(=%EC%9D%B4%EB%A1%A0%EC%A0%81%EC%9D%B8-%EA%B0%92%EC%9D%84-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC).-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B2%80%EC%A6%9D%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(4)</code> $\frac{\partial}{\partial {\bf v}} loss$ 를 해석적으로 계산하라(=이론적인 값을 계산하라). 파이토치를 이용하여 검증하라.<a class="anchor-link" href="#(4)-%24%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial-%7B%5Cbf-v%7D%7D-loss%24-%EB%A5%BC-%ED%95%B4%EC%84%9D%EC%A0%81%EC%9C%BC%EB%A1%9C-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC(=%EC%9D%B4%EB%A1%A0%EC%A0%81%EC%9D%B8-%EA%B0%92%EC%9D%84-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC).-%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B2%80%EC%A6%9D%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([1.2400, 2.7000])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_v</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.2400</span><span class="p">,</span> <span class="mf">2.7000</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_loss</span> <span class="o">=</span> <span class="n">_v</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">_v</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_v</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">v</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([2.4800, 5.4000]), tensor([2.4800, 5.4000]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(5)$\frac{\partial-}{\partial-{\bf-u}}{\bf-v}^\top$와-$\frac{\partial-}{\partial-{\bf-W}}{\bf-u}^\top$의-값을-해석적으로-계산하라.-(파이토치를-이용한-검증은-불필요)">
<a class="anchor" href="#(5)%24%5Cfrac%7B%5Cpartial-%7D%7B%5Cpartial-%7B%5Cbf-u%7D%7D%7B%5Cbf-v%7D%5E%5Ctop%24%EC%99%80-%24%5Cfrac%7B%5Cpartial-%7D%7B%5Cpartial-%7B%5Cbf-W%7D%7D%7B%5Cbf-u%7D%5E%5Ctop%24%EC%9D%98-%EA%B0%92%EC%9D%84-%ED%95%B4%EC%84%9D%EC%A0%81%EC%9C%BC%EB%A1%9C-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-(%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EA%B2%80%EC%A6%9D%EC%9D%80-%EB%B6%88%ED%95%84%EC%9A%94)" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(5)</code>$\frac{\partial }{\partial {\bf u}}{\bf v}^\top$와 $\frac{\partial }{\partial {\bf W}}{\bf u}^\top$의 값을 해석적으로 계산하라. (파이토치를 이용한 검증은 불필요)<a class="anchor-link" href="#(5)%24%5Cfrac%7B%5Cpartial-%7D%7B%5Cpartial-%7B%5Cbf-u%7D%7D%7B%5Cbf-v%7D%5E%5Ctop%24%EC%99%80-%24%5Cfrac%7B%5Cpartial-%7D%7B%5Cpartial-%7B%5Cbf-W%7D%7D%7B%5Cbf-u%7D%5E%5Ctop%24%EC%9D%98-%EA%B0%92%EC%9D%84-%ED%95%B4%EC%84%9D%EC%A0%81%EC%9C%BC%EB%A1%9C-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-(%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EA%B2%80%EC%A6%9D%EC%9D%80-%EB%B6%88%ED%95%84%EC%9A%94)"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> 
    <span class="n">_u</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">3.0</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">_u</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">_v</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">A</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="n">_u</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-1., -0.],
        [-0., -1.]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> 
    <span class="n">_W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">_u</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="nd">@_W</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">_u</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">B</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="n">_W</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">B</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.0000, 1.0000],
        [2.1000, 3.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(6)-(4)~(5)의-결과와-체인룰을-이용하여-$\frac{\partial}{\partial-{\bf-W}}loss$를-계산하라.-그리고-아래의-코드를-이용하여-검증하라.">
<a class="anchor" href="#(6)-(4)~(5)%EC%9D%98-%EA%B2%B0%EA%B3%BC%EC%99%80-%EC%B2%B4%EC%9D%B8%EB%A3%B0%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%24%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial-%7B%5Cbf-W%7D%7Dloss%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%95%84%EB%9E%98%EC%9D%98-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B2%80%EC%A6%9D%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(6)</code> (4)~(5)의 결과와 체인룰을 이용하여 $\frac{\partial}{\partial {\bf W}}loss$를 계산하라. 그리고 아래의 코드를 이용하여 검증하라.<a class="anchor-link" href="#(6)-(4)~(5)%EC%9D%98-%EA%B2%B0%EA%B3%BC%EC%99%80-%EC%B2%B4%EC%9D%B8%EB%A3%B0%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%24%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial-%7B%5Cbf-W%7D%7Dloss%24%EB%A5%BC-%EA%B3%84%EC%82%B0%ED%95%98%EB%9D%BC.-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%95%84%EB%9E%98%EC%9D%98-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B2%80%EC%A6%9D%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">ones</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">3.0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ones</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span><span class="nd">@W</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span><span class="nd">@W</span><span class="p">)</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">W</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">B</span> <span class="o">@</span> <span class="n">_v</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ -7.8800, -21.4080])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">@-</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">@</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ -7.8800, -21.4080])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">ones</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">3.0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ones</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span><span class="nd">@W</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span><span class="nd">@W</span><span class="p">)</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">W</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ -7.8800, -21.4080])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="#2.-음료추천">
<a class="anchor" href="##2.-%EC%9D%8C%EB%A3%8C%EC%B6%94%EC%B2%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>#2</code>. 음료추천<a class="anchor-link" href="##2.-%EC%9D%8C%EB%A3%8C%EC%B6%94%EC%B2%9C"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>아래는 200명의 사용자가 차가운커피, 따뜻한커피, 차가운홍차, 따듯한홍차 각 10종씩을 먹고 평점을 넣은 자료이다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">torch</span> 
<span class="kn">from</span> <span class="nn">fastai.collab</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">fastai.tabular.all</span> <span class="kn">import</span> <span class="o">*</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/guebin/2021BDA/master/_notebooks/2021-12-04-recommend.csv"</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
      <th>item_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>27</td>
      <td>2.677878</td>
      <td>차가운홍차7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>28</td>
      <td>2.382410</td>
      <td>차가운홍차8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>38</td>
      <td>0.952034</td>
      <td>따뜻한홍차8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>21</td>
      <td>2.359307</td>
      <td>차가운홍차1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>24</td>
      <td>2.447412</td>
      <td>차가운홍차4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3995</th>
      <td>200</td>
      <td>28</td>
      <td>2.401077</td>
      <td>차가운홍차8</td>
    </tr>
    <tr>
      <th>3996</th>
      <td>200</td>
      <td>31</td>
      <td>3.798483</td>
      <td>따뜻한홍차1</td>
    </tr>
    <tr>
      <th>3997</th>
      <td>200</td>
      <td>22</td>
      <td>2.104705</td>
      <td>차가운홍차2</td>
    </tr>
    <tr>
      <th>3998</th>
      <td>200</td>
      <td>26</td>
      <td>2.248165</td>
      <td>차가운홍차6</td>
    </tr>
    <tr>
      <th>3999</th>
      <td>200</td>
      <td>39</td>
      <td>4.007320</td>
      <td>따뜻한홍차9</td>
    </tr>
  </tbody>
</table>
<p>4000 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(1)-user-item-matrix-생성하라.">
<a class="anchor" href="#(1)-user-item-matrix-%EC%83%9D%EC%84%B1%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(1)</code> user-item matrix 생성하라.<a class="anchor-link" href="#(1)-user-item-matrix-%EC%83%9D%EC%84%B1%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>생성예시는 아래와 같다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>차가운커피1</th>
      <th>차가운커피2</th>
      <th>차가운커피3</th>
      <th>차가운커피4</th>
      <th>차가운커피5</th>
      <th>차가운커피6</th>
      <th>차가운커피7</th>
      <th>차가운커피8</th>
      <th>차가운커피9</th>
      <th>차가운커피10</th>
      <th>따듯한커피1</th>
      <th>따듯한커피2</th>
      <th>따듯한커피3</th>
      <th>따듯한커피4</th>
      <th>따듯한커피5</th>
      <th>따듯한커피6</th>
      <th>따듯한커피7</th>
      <th>따듯한커피8</th>
      <th>따듯한커피9</th>
      <th>따듯한커피10</th>
      <th>차가운홍차1</th>
      <th>차가운홍차2</th>
      <th>차가운홍차3</th>
      <th>차가운홍차4</th>
      <th>차가운홍차5</th>
      <th>차가운홍차6</th>
      <th>차가운홍차7</th>
      <th>차가운홍차8</th>
      <th>차가운홍차9</th>
      <th>차가운홍차10</th>
      <th>따뜻한홍차1</th>
      <th>따뜻한홍차2</th>
      <th>따뜻한홍차3</th>
      <th>따뜻한홍차4</th>
      <th>따뜻한홍차5</th>
      <th>따뜻한홍차6</th>
      <th>따뜻한홍차7</th>
      <th>따뜻한홍차8</th>
      <th>따뜻한홍차9</th>
      <th>따뜻한홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user1</th>
      <td>None</td>
      <td>3.937672</td>
      <td>None</td>
      <td>3.989888</td>
      <td>4.133222</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.015579</td>
      <td>2.103387</td>
      <td>2.361724</td>
      <td>None</td>
      <td>2.273406</td>
      <td>2.295347</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.791477</td>
      <td>None</td>
      <td>2.359307</td>
      <td>2.565654</td>
      <td>None</td>
      <td>2.447412</td>
      <td>None</td>
      <td>None</td>
      <td>2.677878</td>
      <td>2.38241</td>
      <td>2.194201</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.887225</td>
      <td>1.014088</td>
      <td>None</td>
      <td>0.952034</td>
      <td>0.658081</td>
      <td>1.235058</td>
    </tr>
    <tr>
      <th>user2</th>
      <td>4.098147</td>
      <td>4.094224</td>
      <td>None</td>
      <td>3.765555</td>
      <td>None</td>
      <td>None</td>
      <td>3.988153</td>
      <td>None</td>
      <td>4.349755</td>
      <td>3.640496</td>
      <td>None</td>
      <td>None</td>
      <td>2.707521</td>
      <td>2.765143</td>
      <td>2.310812</td>
      <td>2.458836</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.22282</td>
      <td>2.621137</td>
      <td>None</td>
      <td>2.510424</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.788081</td>
      <td>None</td>
      <td>2.404252</td>
      <td>2.908625</td>
      <td>None</td>
      <td>1.400812</td>
      <td>None</td>
      <td>0.654011</td>
      <td>None</td>
      <td>1.129268</td>
      <td>None</td>
      <td>None</td>
      <td>0.703928</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user3</th>
      <td>3.819119</td>
      <td>None</td>
      <td>4.228748</td>
      <td>3.79414</td>
      <td>None</td>
      <td>4.08909</td>
      <td>3.776395</td>
      <td>None</td>
      <td>4.583121</td>
      <td>None</td>
      <td>None</td>
      <td>2.7361</td>
      <td>None</td>
      <td>2.219188</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.791662</td>
      <td>None</td>
      <td>2.729578</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.494008</td>
      <td>2.440778</td>
      <td>0.695669</td>
      <td>None</td>
      <td>0.840201</td>
      <td>0.960158</td>
      <td>None</td>
      <td>1.019722</td>
      <td>1.287193</td>
      <td>1.354343</td>
      <td>1.237186</td>
      <td>0.985125</td>
    </tr>
    <tr>
      <th>user4</th>
      <td>4.243031</td>
      <td>3.985556</td>
      <td>4.3557</td>
      <td>4.200771</td>
      <td>None</td>
      <td>4.068798</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.149567</td>
      <td>None</td>
      <td>None</td>
      <td>2.466804</td>
      <td>None</td>
      <td>None</td>
      <td>2.104525</td>
      <td>2.341672</td>
      <td>2.463411</td>
      <td>2.56218</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.37737</td>
      <td>2.37356</td>
      <td>None</td>
      <td>2.317104</td>
      <td>2.5877</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.014652</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.09685</td>
      <td>0.664659</td>
      <td>1.148056</td>
      <td>1.302336</td>
    </tr>
    <tr>
      <th>user5</th>
      <td>3.855109</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>3.772252</td>
      <td>4.18115</td>
      <td>4.077935</td>
      <td>None</td>
      <td>3.905809</td>
      <td>2.566041</td>
      <td>2.412227</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.715758</td>
      <td>None</td>
      <td>None</td>
      <td>2.651073</td>
      <td>None</td>
      <td>2.454781</td>
      <td>2.654822</td>
      <td>2.382804</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.599824</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.851721</td>
      <td>1.313315</td>
      <td>None</td>
      <td>1.093123</td>
      <td>None</td>
      <td>0.759305</td>
      <td>1.336896</td>
      <td>None</td>
      <td>0.742396</td>
      <td>1.064772</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>user196</th>
      <td>0.788662</td>
      <td>0.704273</td>
      <td>0.776555</td>
      <td>0.8481</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.686273</td>
      <td>None</td>
      <td>None</td>
      <td>2.164656</td>
      <td>2.549222</td>
      <td>2.614974</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.51912</td>
      <td>2.355786</td>
      <td>2.509917</td>
      <td>2.382942</td>
      <td>2.494133</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.457732</td>
      <td>None</td>
      <td>4.014754</td>
      <td>4.184846</td>
      <td>None</td>
      <td>4.126758</td>
      <td>None</td>
      <td>None</td>
      <td>4.364885</td>
      <td>None</td>
      <td>3.767153</td>
      <td>4.405117</td>
    </tr>
    <tr>
      <th>user197</th>
      <td>1.303235</td>
      <td>1.43626</td>
      <td>1.00433</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.486788</td>
      <td>1.295232</td>
      <td>None</td>
      <td>0.920782</td>
      <td>2.511827</td>
      <td>None</td>
      <td>2.361798</td>
      <td>None</td>
      <td>2.354619</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.21937</td>
      <td>2.401316</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.793289</td>
      <td>None</td>
      <td>2.464333</td>
      <td>2.426258</td>
      <td>4.253895</td>
      <td>None</td>
      <td>None</td>
      <td>4.369466</td>
      <td>None</td>
      <td>3.996908</td>
      <td>3.853673</td>
      <td>None</td>
      <td>3.917286</td>
      <td>4.57724</td>
    </tr>
    <tr>
      <th>user198</th>
      <td>1.251698</td>
      <td>None</td>
      <td>1.017147</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.806444</td>
      <td>None</td>
      <td>2.520115</td>
      <td>2.646957</td>
      <td>None</td>
      <td>2.952988</td>
      <td>None</td>
      <td>None</td>
      <td>2.190244</td>
      <td>None</td>
      <td>None</td>
      <td>2.282611</td>
      <td>None</td>
      <td>2.480411</td>
      <td>2.663661</td>
      <td>2.402259</td>
      <td>None</td>
      <td>None</td>
      <td>2.708267</td>
      <td>2.109672</td>
      <td>2.824608</td>
      <td>4.380199</td>
      <td>4.022162</td>
      <td>None</td>
      <td>3.895619</td>
      <td>None</td>
      <td>3.887536</td>
      <td>None</td>
      <td>3.862879</td>
      <td>None</td>
      <td>4.261574</td>
    </tr>
    <tr>
      <th>user199</th>
      <td>1.007993</td>
      <td>None</td>
      <td>0.955789</td>
      <td>None</td>
      <td>0.846838</td>
      <td>None</td>
      <td>0.58893</td>
      <td>1.046728</td>
      <td>None</td>
      <td>1.139212</td>
      <td>2.739859</td>
      <td>2.459454</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.430707</td>
      <td>None</td>
      <td>2.413188</td>
      <td>2.608065</td>
      <td>None</td>
      <td>None</td>
      <td>2.764538</td>
      <td>2.389897</td>
      <td>2.29379</td>
      <td>None</td>
      <td>2.428555</td>
      <td>2.406729</td>
      <td>2.507149</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.039527</td>
      <td>None</td>
      <td>None</td>
      <td>3.837071</td>
      <td>4.103043</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user200</th>
      <td>0.717826</td>
      <td>None</td>
      <td>1.23011</td>
      <td>None</td>
      <td>0.994098</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.14695</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.487716</td>
      <td>2.56307</td>
      <td>None</td>
      <td>None</td>
      <td>2.300041</td>
      <td>2.552453</td>
      <td>2.104705</td>
      <td>2.862709</td>
      <td>2.416833</td>
      <td>None</td>
      <td>2.248165</td>
      <td>2.401267</td>
      <td>2.401077</td>
      <td>None</td>
      <td>2.21877</td>
      <td>3.798483</td>
      <td>None</td>
      <td>4.224537</td>
      <td>None</td>
      <td>None</td>
      <td>4.117838</td>
      <td>None</td>
      <td>3.920277</td>
      <td>4.00732</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">40</span><span class="p">]</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'차가운커피'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">'따뜻한커피'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">'차가운홍차'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">'따뜻한홍차'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span> 
<span class="n">df2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">'user'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">201</span><span class="p">)])</span>
<span class="n">df2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>차가운커피1</th>
      <th>차가운커피2</th>
      <th>차가운커피3</th>
      <th>차가운커피4</th>
      <th>차가운커피5</th>
      <th>차가운커피6</th>
      <th>차가운커피7</th>
      <th>차가운커피8</th>
      <th>차가운커피9</th>
      <th>차가운커피10</th>
      <th>...</th>
      <th>따뜻한홍차1</th>
      <th>따뜻한홍차2</th>
      <th>따뜻한홍차3</th>
      <th>따뜻한홍차4</th>
      <th>따뜻한홍차5</th>
      <th>따뜻한홍차6</th>
      <th>따뜻한홍차7</th>
      <th>따뜻한홍차8</th>
      <th>따뜻한홍차9</th>
      <th>따뜻한홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user1</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user2</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user3</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user4</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user5</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>user196</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user197</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user198</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user199</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user200</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">to_list</span><span class="p">()):</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">'user == @i and item == @j'</span><span class="p">)[</span><span class="s1">'rating'</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>차가운커피1</th>
      <th>차가운커피2</th>
      <th>차가운커피3</th>
      <th>차가운커피4</th>
      <th>차가운커피5</th>
      <th>차가운커피6</th>
      <th>차가운커피7</th>
      <th>차가운커피8</th>
      <th>차가운커피9</th>
      <th>차가운커피10</th>
      <th>...</th>
      <th>따뜻한홍차1</th>
      <th>따뜻한홍차2</th>
      <th>따뜻한홍차3</th>
      <th>따뜻한홍차4</th>
      <th>따뜻한홍차5</th>
      <th>따뜻한홍차6</th>
      <th>따뜻한홍차7</th>
      <th>따뜻한홍차8</th>
      <th>따뜻한홍차9</th>
      <th>따뜻한홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user1</th>
      <td>None</td>
      <td>3.937672</td>
      <td>None</td>
      <td>3.989888</td>
      <td>4.133222</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.015579</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.887225</td>
      <td>1.014088</td>
      <td>None</td>
      <td>0.952034</td>
      <td>0.658081</td>
      <td>1.235058</td>
    </tr>
    <tr>
      <th>user2</th>
      <td>4.098147</td>
      <td>4.094224</td>
      <td>None</td>
      <td>3.765555</td>
      <td>None</td>
      <td>None</td>
      <td>3.988153</td>
      <td>None</td>
      <td>4.349755</td>
      <td>3.640496</td>
      <td>...</td>
      <td>None</td>
      <td>1.400812</td>
      <td>None</td>
      <td>0.654011</td>
      <td>None</td>
      <td>1.129268</td>
      <td>None</td>
      <td>None</td>
      <td>0.703928</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user3</th>
      <td>3.819119</td>
      <td>None</td>
      <td>4.228748</td>
      <td>3.79414</td>
      <td>None</td>
      <td>4.08909</td>
      <td>3.776395</td>
      <td>None</td>
      <td>4.583121</td>
      <td>None</td>
      <td>...</td>
      <td>0.695669</td>
      <td>None</td>
      <td>0.840201</td>
      <td>0.960158</td>
      <td>None</td>
      <td>1.019722</td>
      <td>1.287193</td>
      <td>1.354343</td>
      <td>1.237186</td>
      <td>0.985125</td>
    </tr>
    <tr>
      <th>user4</th>
      <td>4.243031</td>
      <td>3.985556</td>
      <td>4.3557</td>
      <td>4.200771</td>
      <td>None</td>
      <td>4.068798</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.149567</td>
      <td>...</td>
      <td>1.014652</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.09685</td>
      <td>0.664659</td>
      <td>1.148056</td>
      <td>1.302336</td>
    </tr>
    <tr>
      <th>user5</th>
      <td>3.855109</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>3.772252</td>
      <td>4.18115</td>
      <td>4.077935</td>
      <td>None</td>
      <td>3.905809</td>
      <td>...</td>
      <td>0.851721</td>
      <td>1.313315</td>
      <td>None</td>
      <td>1.093123</td>
      <td>None</td>
      <td>0.759305</td>
      <td>1.336896</td>
      <td>None</td>
      <td>0.742396</td>
      <td>1.064772</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>user196</th>
      <td>0.788662</td>
      <td>0.704273</td>
      <td>0.776555</td>
      <td>0.8481</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.686273</td>
      <td>None</td>
      <td>None</td>
      <td>...</td>
      <td>4.014754</td>
      <td>4.184846</td>
      <td>None</td>
      <td>4.126758</td>
      <td>None</td>
      <td>None</td>
      <td>4.364885</td>
      <td>None</td>
      <td>3.767153</td>
      <td>4.405117</td>
    </tr>
    <tr>
      <th>user197</th>
      <td>1.303235</td>
      <td>1.43626</td>
      <td>1.00433</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.486788</td>
      <td>1.295232</td>
      <td>None</td>
      <td>0.920782</td>
      <td>...</td>
      <td>4.253895</td>
      <td>None</td>
      <td>None</td>
      <td>4.369466</td>
      <td>None</td>
      <td>3.996908</td>
      <td>3.853673</td>
      <td>None</td>
      <td>3.917286</td>
      <td>4.57724</td>
    </tr>
    <tr>
      <th>user198</th>
      <td>1.251698</td>
      <td>None</td>
      <td>1.017147</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.806444</td>
      <td>...</td>
      <td>4.380199</td>
      <td>4.022162</td>
      <td>None</td>
      <td>3.895619</td>
      <td>None</td>
      <td>3.887536</td>
      <td>None</td>
      <td>3.862879</td>
      <td>None</td>
      <td>4.261574</td>
    </tr>
    <tr>
      <th>user199</th>
      <td>1.007993</td>
      <td>None</td>
      <td>0.955789</td>
      <td>None</td>
      <td>0.846838</td>
      <td>None</td>
      <td>0.58893</td>
      <td>1.046728</td>
      <td>None</td>
      <td>1.139212</td>
      <td>...</td>
      <td>None</td>
      <td>4.039527</td>
      <td>None</td>
      <td>None</td>
      <td>3.837071</td>
      <td>4.103043</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user200</th>
      <td>0.717826</td>
      <td>None</td>
      <td>1.23011</td>
      <td>None</td>
      <td>0.994098</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.14695</td>
      <td>None</td>
      <td>...</td>
      <td>3.798483</td>
      <td>None</td>
      <td>4.224537</td>
      <td>None</td>
      <td>None</td>
      <td>4.117838</td>
      <td>None</td>
      <td>3.920277</td>
      <td>4.00732</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(2)-첫번째-유저를-평점을-조회하고-이-유저의-취향을-서술하라.-커피와-홍차중-어떤음료를-선호하는가?-따듯한-음료와-차가운-음료중-어떤-음료를-선호하는가?">
<a class="anchor" href="#(2)-%EC%B2%AB%EB%B2%88%EC%A7%B8-%EC%9C%A0%EC%A0%80%EB%A5%BC-%ED%8F%89%EC%A0%90%EC%9D%84-%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B3%A0-%EC%9D%B4-%EC%9C%A0%EC%A0%80%EC%9D%98-%EC%B7%A8%ED%96%A5%EC%9D%84-%EC%84%9C%EC%88%A0%ED%95%98%EB%9D%BC.-%EC%BB%A4%ED%94%BC%EC%99%80-%ED%99%8D%EC%B0%A8%EC%A4%91-%EC%96%B4%EB%96%A4%EC%9D%8C%EB%A3%8C%EB%A5%BC-%EC%84%A0%ED%98%B8%ED%95%98%EB%8A%94%EA%B0%80?-%EB%94%B0%EB%93%AF%ED%95%9C-%EC%9D%8C%EB%A3%8C%EC%99%80-%EC%B0%A8%EA%B0%80%EC%9A%B4-%EC%9D%8C%EB%A3%8C%EC%A4%91-%EC%96%B4%EB%96%A4-%EC%9D%8C%EB%A3%8C%EB%A5%BC-%EC%84%A0%ED%98%B8%ED%95%98%EB%8A%94%EA%B0%80?" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(2)</code> 첫번째 유저를 평점을 조회하고 이 유저의 취향을 서술하라. 커피와 홍차중 어떤음료를 선호하는가? 따듯한 음료와 차가운 음료중 어떤 음료를 선호하는가?<a class="anchor-link" href="#(2)-%EC%B2%AB%EB%B2%88%EC%A7%B8-%EC%9C%A0%EC%A0%80%EB%A5%BC-%ED%8F%89%EC%A0%90%EC%9D%84-%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B3%A0-%EC%9D%B4-%EC%9C%A0%EC%A0%80%EC%9D%98-%EC%B7%A8%ED%96%A5%EC%9D%84-%EC%84%9C%EC%88%A0%ED%95%98%EB%9D%BC.-%EC%BB%A4%ED%94%BC%EC%99%80-%ED%99%8D%EC%B0%A8%EC%A4%91-%EC%96%B4%EB%96%A4%EC%9D%8C%EB%A3%8C%EB%A5%BC-%EC%84%A0%ED%98%B8%ED%95%98%EB%8A%94%EA%B0%80?-%EB%94%B0%EB%93%AF%ED%95%9C-%EC%9D%8C%EB%A3%8C%EC%99%80-%EC%B0%A8%EA%B0%80%EC%9A%B4-%EC%9D%8C%EB%A3%8C%EC%A4%91-%EC%96%B4%EB%96%A4-%EC%9D%8C%EB%A3%8C%EB%A5%BC-%EC%84%A0%ED%98%B8%ED%95%98%EB%8A%94%EA%B0%80?"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>차가운커피1         None
차가운커피2     3.937672
차가운커피3         None
차가운커피4     3.989888
차가운커피5     4.133222
차가운커피6         None
차가운커피7         None
차가운커피8         None
차가운커피9         None
차가운커피10    4.015579
따뜻한커피1     2.103387
따뜻한커피2     2.361724
따뜻한커피3         None
따뜻한커피4     2.273406
따뜻한커피5     2.295347
따뜻한커피6         None
따뜻한커피7         None
따뜻한커피8         None
따뜻한커피9     2.791477
따뜻한커피10        None
차가운홍차1     2.359307
차가운홍차2     2.565654
차가운홍차3         None
차가운홍차4     2.447412
차가운홍차5         None
차가운홍차6         None
차가운홍차7     2.677878
차가운홍차8      2.38241
차가운홍차9     2.194201
차가운홍차10        None
따뜻한홍차1         None
따뜻한홍차2         None
따뜻한홍차3         None
따뜻한홍차4         None
따뜻한홍차5     0.887225
따뜻한홍차6     1.014088
따뜻한홍차7         None
따뜻한홍차8     0.952034
따뜻한홍차9     0.658081
따뜻한홍차10    1.235058
Name: user1, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>따뜻한 커피보다는 차가운 커피를 더 선호하는 것 같고, 따뜻한 음료보다는 차가운 음료를 선호하는 것 같다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(3)-fastai를-이용하여-추천모형을-학습하라.-(nn을-사용하지-않아도-무방하다.)">
<a class="anchor" href="#(3)-fastai%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%B6%94%EC%B2%9C%EB%AA%A8%ED%98%95%EC%9D%84-%ED%95%99%EC%8A%B5%ED%95%98%EB%9D%BC.-(nn%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EC%95%84%EB%8F%84-%EB%AC%B4%EB%B0%A9%ED%95%98%EB%8B%A4.)" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(3)</code> fastai를 이용하여 추천모형을 학습하라. (<code>nn</code>을 사용하지 않아도 무방하다.)<a class="anchor-link" href="#(3)-fastai%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%B6%94%EC%B2%9C%EB%AA%A8%ED%98%95%EC%9D%84-%ED%95%99%EC%8A%B5%ED%95%98%EB%9D%BC.-(nn%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EC%95%84%EB%8F%84-%EB%AC%B4%EB%B0%A9%ED%95%98%EB%8B%A4.)"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">CollabDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">items</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
      <th>item_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2030</th>
      <td>102</td>
      <td>11</td>
      <td>0.957028</td>
      <td>따듯한커피1</td>
    </tr>
    <tr>
      <th>2689</th>
      <td>135</td>
      <td>17</td>
      <td>0.974055</td>
      <td>따듯한커피7</td>
    </tr>
    <tr>
      <th>1652</th>
      <td>83</td>
      <td>26</td>
      <td>1.042701</td>
      <td>차가운홍차6</td>
    </tr>
    <tr>
      <th>1063</th>
      <td>54</td>
      <td>27</td>
      <td>0.965986</td>
      <td>차가운홍차7</td>
    </tr>
    <tr>
      <th>1873</th>
      <td>94</td>
      <td>24</td>
      <td>1.136094</td>
      <td>차가운홍차4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3595</th>
      <td>180</td>
      <td>5</td>
      <td>1.180172</td>
      <td>차가운커피5</td>
    </tr>
    <tr>
      <th>3965</th>
      <td>199</td>
      <td>22</td>
      <td>2.764538</td>
      <td>차가운홍차2</td>
    </tr>
    <tr>
      <th>2215</th>
      <td>111</td>
      <td>31</td>
      <td>2.377901</td>
      <td>따뜻한홍차1</td>
    </tr>
    <tr>
      <th>2920</th>
      <td>147</td>
      <td>24</td>
      <td>3.935108</td>
      <td>차가운홍차4</td>
    </tr>
    <tr>
      <th>2593</th>
      <td>130</td>
      <td>1</td>
      <td>2.314916</td>
      <td>차가운커피1</td>
    </tr>
  </tbody>
</table>
<p>3200 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span> <span class="o">=</span> <span class="n">collab_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">lrnr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.187016</td>
      <td>1.097175</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.132885</td>
      <td>0.986906</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.994547</td>
      <td>0.674259</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.773934</td>
      <td>0.298967</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.552205</td>
      <td>0.106625</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.390826</td>
      <td>0.065410</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.283230</td>
      <td>0.058494</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.209869</td>
      <td>0.057090</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.158989</td>
      <td>0.056235</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.123309</td>
      <td>0.055232</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.098035</td>
      <td>0.055365</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.079922</td>
      <td>0.054929</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.067054</td>
      <td>0.056076</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.057767</td>
      <td>0.055572</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.051069</td>
      <td>0.056253</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.046277</td>
      <td>0.057279</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.042751</td>
      <td>0.056172</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.040254</td>
      <td>0.057400</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.038407</td>
      <td>0.056913</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.037115</td>
      <td>0.057196</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.036142</td>
      <td>0.057445</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.035268</td>
      <td>0.057364</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.034693</td>
      <td>0.057553</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.034215</td>
      <td>0.058029</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.033800</td>
      <td>0.057356</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.033358</td>
      <td>0.057974</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.032996</td>
      <td>0.057489</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.032599</td>
      <td>0.058639</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.032370</td>
      <td>0.058777</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.032010</td>
      <td>0.058919</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(4)-(3)의-추천시스템을-이용하여-모든-음료(총40개)에-대하여-144번-유저의-fitted-rating-을-구하라.-144번-유저는-어떤-취향인가?">
<a class="anchor" href="#(4)-(3)%EC%9D%98-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AA%A8%EB%93%A0-%EC%9D%8C%EB%A3%8C(%EC%B4%9D40%EA%B0%9C)%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-144%EB%B2%88-%EC%9C%A0%EC%A0%80%EC%9D%98-fitted-rating-%EC%9D%84-%EA%B5%AC%ED%95%98%EB%9D%BC.-144%EB%B2%88-%EC%9C%A0%EC%A0%80%EB%8A%94-%EC%96%B4%EB%96%A4-%EC%B7%A8%ED%96%A5%EC%9D%B8%EA%B0%80?" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(4)</code> (3)의 추천시스템을 이용하여 모든 음료(총40개)에 대하여 144번 유저의 <code>fitted rating</code> 을 구하라. 144번 유저는 어떤 취향인가?<a class="anchor-link" href="#(4)-(3)%EC%9D%98-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AA%A8%EB%93%A0-%EC%9D%8C%EB%A3%8C(%EC%B4%9D40%EA%B0%9C)%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-144%EB%B2%88-%EC%9C%A0%EC%A0%80%EC%9D%98-fitted-rating-%EC%9D%84-%EA%B5%AC%ED%95%98%EB%9D%BC.-144%EB%B2%88-%EC%9C%A0%EC%A0%80%EB%8A%94-%EC%96%B4%EB%96%A4-%EC%B7%A8%ED%96%A5%EC%9D%B8%EA%B0%80?"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x144</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">144</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x144</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda:0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([2.5086, 2.4434, 2.3787, 2.3671, 2.3752, 2.3470, 2.5660, 2.4663, 2.3122,
        2.5410, 1.0356, 1.1298, 1.1237, 1.0032, 1.0872, 1.0394, 0.9993, 1.0948,
        0.9525, 1.0109, 3.9269, 3.7818, 3.8785, 3.8533, 3.9777, 3.8690, 3.8268,
        3.9350, 3.8300, 3.9017, 2.3461, 2.4903, 2.4714, 2.4518, 2.4859, 2.4408,
        2.4442, 2.4606, 2.4151, 2.5207], device='cuda:0',
       grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>따뜻한 것보다는 차가운 것을 선호하고, 커피보다는 홍차를 선호한다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(5)-차가운커피1에-대한-모든유저(총200명)의-fitted-rating을-구하라.-몇번부터-몇번까지의-유저가-차가운-커피를-선호하는가?">
<a class="anchor" href="#(5)-%EC%B0%A8%EA%B0%80%EC%9A%B4%EC%BB%A4%ED%94%BC1%EC%97%90-%EB%8C%80%ED%95%9C-%EB%AA%A8%EB%93%A0%EC%9C%A0%EC%A0%80(%EC%B4%9D200%EB%AA%85)%EC%9D%98-fitted-rating%EC%9D%84-%EA%B5%AC%ED%95%98%EB%9D%BC.-%EB%AA%87%EB%B2%88%EB%B6%80%ED%84%B0-%EB%AA%87%EB%B2%88%EA%B9%8C%EC%A7%80%EC%9D%98-%EC%9C%A0%EC%A0%80%EA%B0%80-%EC%B0%A8%EA%B0%80%EC%9A%B4-%EC%BB%A4%ED%94%BC%EB%A5%BC-%EC%84%A0%ED%98%B8%ED%95%98%EB%8A%94%EA%B0%80?" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(5)</code> 차가운커피1에 대한 모든유저(총200명)의 <code>fitted rating</code>을 구하라. 몇번부터 몇번까지의 유저가 차가운 커피를 선호하는가?<a class="anchor-link" href="#(5)-%EC%B0%A8%EA%B0%80%EC%9A%B4%EC%BB%A4%ED%94%BC1%EC%97%90-%EB%8C%80%ED%95%9C-%EB%AA%A8%EB%93%A0%EC%9C%A0%EC%A0%80(%EC%B4%9D200%EB%AA%85)%EC%9D%98-fitted-rating%EC%9D%84-%EA%B5%AC%ED%95%98%EB%9D%BC.-%EB%AA%87%EB%B2%88%EB%B6%80%ED%84%B0-%EB%AA%87%EB%B2%88%EA%B9%8C%EC%A7%80%EC%9D%98-%EC%9C%A0%EC%A0%80%EA%B0%80-%EC%B0%A8%EA%B0%80%EC%9A%B4-%EC%BB%A4%ED%94%BC%EB%A5%BC-%EC%84%A0%ED%98%B8%ED%95%98%EB%8A%94%EA%B0%80?"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y200</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">201</span><span class="p">)</span> <span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">y200</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda:0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([4.0307, 3.9342, 3.9372, 4.0616, 3.9890, 4.1917, 4.0492, 3.9227, 4.0169,
        4.0119, 3.8937, 4.0132, 3.9489, 3.9400, 4.0705, 3.8897, 3.9464, 4.0079,
        4.0021, 3.9821, 3.8712, 3.9630, 4.0100, 3.9272, 3.9372, 3.9122, 4.0236,
        3.9831, 3.9159, 4.0026, 3.8776, 4.1160, 4.0420, 3.9028, 3.8675, 3.9697,
        4.0159, 3.9916, 4.0962, 3.9461, 4.0571, 4.0299, 4.0056, 3.8416, 3.9038,
        4.0665, 4.0428, 3.9875, 3.8992, 3.9494, 2.3476, 2.3713, 2.4418, 2.4077,
        2.5568, 2.4489, 2.4081, 2.4093, 2.5145, 2.6321, 2.6104, 2.3875, 2.5014,
        2.5568, 2.3744, 2.5192, 2.5545, 2.4501, 2.5179, 2.6041, 2.5477, 2.5135,
        2.6937, 2.6739, 2.4849, 2.6132, 2.5985, 2.3677, 2.6616, 2.5425, 2.4946,
        2.3571, 2.4904, 2.5340, 2.3980, 2.5443, 2.5990, 2.7054, 2.6373, 2.8059,
        2.5896, 2.3616, 2.3839, 2.5014, 2.4420, 2.3765, 2.6235, 2.3284, 2.5282,
        2.4882, 2.5021, 2.6593, 2.4707, 2.5397, 2.5260, 2.5570, 2.7532, 2.8283,
        2.5673, 2.5643, 2.4518, 2.5750, 2.3708, 2.4444, 2.4195, 2.3766, 2.7532,
        2.7490, 2.3548, 2.4608, 2.1720, 2.6812, 2.4438, 2.6737, 2.5101, 2.6943,
        2.4171, 2.5449, 2.4094, 2.3245, 2.3912, 2.3495, 2.6789, 2.6022, 2.5185,
        2.4704, 2.4714, 2.6119, 2.6751, 2.4093, 2.6280, 2.5218, 2.4337, 2.5086,
        2.6370, 2.4458, 2.4652, 2.5439, 2.6842, 2.3492, 1.1037, 0.9217, 1.0008,
        1.0509, 1.1303, 1.0044, 0.9332, 1.0595, 1.0925, 0.9502, 1.0263, 0.9593,
        0.9552, 0.8511, 1.2146, 1.0233, 1.0399, 1.0169, 1.0579, 1.1242, 0.9761,
        0.9685, 1.1077, 0.8608, 1.0976, 1.0279, 1.0787, 1.0907, 1.0640, 0.9867,
        0.8604, 1.1144, 1.0012, 1.0196, 0.8719, 1.0122, 1.0339, 1.0094, 0.9931,
        1.0014, 1.0294, 0.9996, 1.0137, 0.9285, 1.0147, 0.8326, 1.1660, 1.0500,
        0.8367, 0.9081], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>55번째 user까지 차가운 커피를 선호한다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="#3.-영화추천">
<a class="anchor" href="##3.-%EC%98%81%ED%99%94%EC%B6%94%EC%B2%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>#3</code>. 영화추천<a class="anchor-link" href="##3.-%EC%98%81%ED%99%94%EC%B6%94%EC%B2%9C"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>아래의 코드를 이용하여 자료를 받고 <code>df</code>를 만든뒤 물음에 답하라.</p>
<div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ML_100k</span><span class="p">)</span> 
<span class="n">ratings</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'u.data'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">'user'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">,</span><span class="s1">'rating'</span><span class="p">,</span><span class="s1">'timestamp'</span><span class="p">])</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'u.item'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'|'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">'movie'</span><span class="p">,</span><span class="s1">'title'</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">movies</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ML_100k</span><span class="p">)</span> 
<span class="n">ratings</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'u.data'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">'user'</span><span class="p">,</span><span class="s1">'movie'</span><span class="p">,</span><span class="s1">'rating'</span><span class="p">,</span><span class="s1">'timestamp'</span><span class="p">])</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'u.item'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'|'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">'movie'</span><span class="p">,</span><span class="s1">'title'</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">movies</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>movie</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>196</td>
      <td>242</td>
      <td>3</td>
      <td>881250949</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63</td>
      <td>242</td>
      <td>3</td>
      <td>875747190</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>226</td>
      <td>242</td>
      <td>5</td>
      <td>883888671</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>154</td>
      <td>242</td>
      <td>3</td>
      <td>879138235</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>306</td>
      <td>242</td>
      <td>5</td>
      <td>876503793</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>840</td>
      <td>1674</td>
      <td>4</td>
      <td>891211682</td>
      <td>Mamma Roma (1962)</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>655</td>
      <td>1640</td>
      <td>3</td>
      <td>888474646</td>
      <td>Eighth Day, The (1996)</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>655</td>
      <td>1637</td>
      <td>3</td>
      <td>888984255</td>
      <td>Girls Town (1996)</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>655</td>
      <td>1630</td>
      <td>3</td>
      <td>887428735</td>
      <td>Silence of the Palace, The (Saimt el Qusur) (1994)</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>655</td>
      <td>1641</td>
      <td>3</td>
      <td>887427810</td>
      <td>Dadetown (1995)</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(1)-fastai를-이용하여-추천모형을-학습하라.-(nn을-사용하지-않아도-무방하다.)">
<a class="anchor" href="#(1)-fastai%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%B6%94%EC%B2%9C%EB%AA%A8%ED%98%95%EC%9D%84-%ED%95%99%EC%8A%B5%ED%95%98%EB%9D%BC.-(nn%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EC%95%84%EB%8F%84-%EB%AC%B4%EB%B0%A9%ED%95%98%EB%8B%A4.)" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(1)</code> fastai를 이용하여 추천모형을 학습하라. (<code>nn</code>을 사용하지 않아도 무방하다.)<a class="anchor-link" href="#(1)-fastai%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%B6%94%EC%B2%9C%EB%AA%A8%ED%98%95%EC%9D%84-%ED%95%99%EC%8A%B5%ED%95%98%EB%9D%BC.-(nn%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EC%95%84%EB%8F%84-%EB%AC%B4%EB%B0%A9%ED%95%98%EB%8B%A4.)"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">CollabDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span><span class="n">item_name</span><span class="o">=</span><span class="s1">'title'</span><span class="p">)</span> 
<span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>title</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>465</td>
      <td>Big Sleep, The (1946)</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>535</td>
      <td>Some Like It Hot (1959)</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>618</td>
      <td>Birdcage, The (1996)</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>731</td>
      <td>Miracle on 34th Street (1994)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>894</td>
      <td>Mystery Science Theater 3000: The Movie (1996)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>30</td>
      <td>Anaconda (1997)</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>551</td>
      <td>While You Were Sleeping (1995)</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>197</td>
      <td>Butch Cassidy and the Sundance Kid (1969)</td>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>816</td>
      <td>Mimic (1997)</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>216</td>
      <td>Shine (1996)</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span> <span class="o">=</span> <span class="n">collab_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">use_nn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> 
<span class="n">lrnr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.911590</td>
      <td>0.926560</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.892155</td>
      <td>0.892765</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.829315</td>
      <td>0.878876</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.821508</td>
      <td>0.872383</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.820626</td>
      <td>0.873852</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.772432</td>
      <td>0.879065</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.770707</td>
      <td>0.882653</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.723726</td>
      <td>0.900044</td>
      <td>00:07</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span><span class="o">.</span><span class="n">show_results</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>title</th>
      <th>rating</th>
      <th>rating_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>663</td>
      <td>412</td>
      <td>4</td>
      <td>2.837234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>943</td>
      <td>1265</td>
      <td>2</td>
      <td>3.180738</td>
    </tr>
    <tr>
      <th>2</th>
      <td>883</td>
      <td>1300</td>
      <td>2</td>
      <td>4.118921</td>
    </tr>
    <tr>
      <th>3</th>
      <td>125</td>
      <td>864</td>
      <td>3</td>
      <td>2.721634</td>
    </tr>
    <tr>
      <th>4</th>
      <td>437</td>
      <td>114</td>
      <td>5</td>
      <td>3.010027</td>
    </tr>
    <tr>
      <th>5</th>
      <td>404</td>
      <td>333</td>
      <td>4</td>
      <td>3.980665</td>
    </tr>
    <tr>
      <th>6</th>
      <td>42</td>
      <td>617</td>
      <td>5</td>
      <td>3.818271</td>
    </tr>
    <tr>
      <th>7</th>
      <td>89</td>
      <td>1621</td>
      <td>3</td>
      <td>3.644624</td>
    </tr>
    <tr>
      <th>8</th>
      <td>648</td>
      <td>842</td>
      <td>1</td>
      <td>3.735309</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(2)-아래의-영화들에-대한-30번유저의-fitted-rating을-구하라.">
<a class="anchor" href="#(2)-%EC%95%84%EB%9E%98%EC%9D%98-%EC%98%81%ED%99%94%EB%93%A4%EC%97%90-%EB%8C%80%ED%95%9C-30%EB%B2%88%EC%9C%A0%EC%A0%80%EC%9D%98-fitted-rating%EC%9D%84-%EA%B5%AC%ED%95%98%EB%9D%BC." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(2)</code> 아래의 영화들에 대한 30번유저의 <code>fitted rating</code>을 구하라.<a class="anchor-link" href="#(2)-%EC%95%84%EB%9E%98%EC%9D%98-%EC%98%81%ED%99%94%EB%93%A4%EC%97%90-%EB%8C%80%ED%95%9C-30%EB%B2%88%EC%9C%A0%EC%A0%80%EC%9D%98-fitted-rating%EC%9D%84-%EA%B5%AC%ED%95%98%EB%9D%BC."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>1461    Terminator 2: Judgment Day (1991)
1462               Terminator, The (1984)</code></pre>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1461</span><span class="p">]])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda:0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[4.6221]], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrnr</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">30</span><span class="p">,</span><span class="mi">1462</span><span class="p">]])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda:0"</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[4.3273]], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="#4.-다음을-읽고-물음에-답하라.-(O/X로-답할것)">
<a class="anchor" href="##4.-%EB%8B%A4%EC%9D%8C%EC%9D%84-%EC%9D%BD%EA%B3%A0-%EB%AC%BC%EC%9D%8C%EC%97%90-%EB%8B%B5%ED%95%98%EB%9D%BC.-(O/X%EB%A1%9C-%EB%8B%B5%ED%95%A0%EA%B2%83)" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>#4</code>. 다음을 읽고 물음에 답하라. (O/X로 답할것)<a class="anchor-link" href="##4.-%EB%8B%A4%EC%9D%8C%EC%9D%84-%EC%9D%BD%EA%B3%A0-%EB%AC%BC%EC%9D%8C%EC%97%90-%EB%8B%B5%ED%95%98%EB%9D%BC.-(O/X%EB%A1%9C-%EB%8B%B5%ED%95%A0%EA%B2%83)"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(1)-학습이-진행됨에-따라-training-loss는-줄어들지만-validation-loss가-증가하는-현상을-기울기소실문제라고-한다.">
<a class="anchor" href="#(1)-%ED%95%99%EC%8A%B5%EC%9D%B4-%EC%A7%84%ED%96%89%EB%90%A8%EC%97%90-%EB%94%B0%EB%9D%BC-training-loss%EB%8A%94-%EC%A4%84%EC%96%B4%EB%93%A4%EC%A7%80%EB%A7%8C-validation-loss%EA%B0%80-%EC%A6%9D%EA%B0%80%ED%95%98%EB%8A%94-%ED%98%84%EC%83%81%EC%9D%84-%EA%B8%B0%EC%9A%B8%EA%B8%B0%EC%86%8C%EC%8B%A4%EB%AC%B8%EC%A0%9C%EB%9D%BC%EA%B3%A0-%ED%95%9C%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(1)</code> 학습이 진행됨에 따라 training loss는 줄어들지만 validation loss가 증가하는 현상을 기울기소실문제라고 한다.<a class="anchor-link" href="#(1)-%ED%95%99%EC%8A%B5%EC%9D%B4-%EC%A7%84%ED%96%89%EB%90%A8%EC%97%90-%EB%94%B0%EB%9D%BC-training-loss%EB%8A%94-%EC%A4%84%EC%96%B4%EB%93%A4%EC%A7%80%EB%A7%8C-validation-loss%EA%B0%80-%EC%A6%9D%EA%B0%80%ED%95%98%EB%8A%94-%ED%98%84%EC%83%81%EC%9D%84-%EA%B8%B0%EC%9A%B8%EA%B8%B0%EC%86%8C%EC%8B%A4%EB%AC%B8%EC%A0%9C%EB%9D%BC%EA%B3%A0-%ED%95%9C%EB%8B%A4."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>X</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(2)-배치정규화는-기울기소실문제를-해결하는-방법-중-하나이다.">
<a class="anchor" href="#(2)-%EB%B0%B0%EC%B9%98%EC%A0%95%EA%B7%9C%ED%99%94%EB%8A%94-%EA%B8%B0%EC%9A%B8%EA%B8%B0%EC%86%8C%EC%8B%A4%EB%AC%B8%EC%A0%9C%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EC%A4%91-%ED%95%98%EB%82%98%EC%9D%B4%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(2)</code> 배치정규화는 기울기소실문제를 해결하는 방법 중 하나이다.<a class="anchor-link" href="#(2)-%EB%B0%B0%EC%B9%98%EC%A0%95%EA%B7%9C%ED%99%94%EB%8A%94-%EA%B8%B0%EC%9A%B8%EA%B8%B0%EC%86%8C%EC%8B%A4%EB%AC%B8%EC%A0%9C%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EC%A4%91-%ED%95%98%EB%82%98%EC%9D%B4%EB%8B%A4."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>O</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(3)-기울기소실은-얕은신경망보다-깊은신경망에서-자주-발생한다.">
<a class="anchor" href="#(3)-%EA%B8%B0%EC%9A%B8%EA%B8%B0%EC%86%8C%EC%8B%A4%EC%9D%80-%EC%96%95%EC%9D%80%EC%8B%A0%EA%B2%BD%EB%A7%9D%EB%B3%B4%EB%8B%A4-%EA%B9%8A%EC%9D%80%EC%8B%A0%EA%B2%BD%EB%A7%9D%EC%97%90%EC%84%9C-%EC%9E%90%EC%A3%BC-%EB%B0%9C%EC%83%9D%ED%95%9C%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(3)</code> 기울기소실은 얕은신경망보다 깊은신경망에서 자주 발생한다.<a class="anchor-link" href="#(3)-%EA%B8%B0%EC%9A%B8%EA%B8%B0%EC%86%8C%EC%8B%A4%EC%9D%80-%EC%96%95%EC%9D%80%EC%8B%A0%EA%B2%BD%EB%A7%9D%EB%B3%B4%EB%8B%A4-%EA%B9%8A%EC%9D%80%EC%8B%A0%EA%B2%BD%EB%A7%9D%EC%97%90%EC%84%9C-%EC%9E%90%EC%A3%BC-%EB%B0%9C%EC%83%9D%ED%95%9C%EB%8B%A4."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>O</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(4)-역전파기법은-과적합을-방지하는-테크닉중-하나이다.">
<a class="anchor" href="#(4)-%EC%97%AD%EC%A0%84%ED%8C%8C%EA%B8%B0%EB%B2%95%EC%9D%80-%EA%B3%BC%EC%A0%81%ED%95%A9%EC%9D%84-%EB%B0%A9%EC%A7%80%ED%95%98%EB%8A%94-%ED%85%8C%ED%81%AC%EB%8B%89%EC%A4%91-%ED%95%98%EB%82%98%EC%9D%B4%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(4)</code> 역전파기법은 과적합을 방지하는 테크닉중 하나이다.<a class="anchor-link" href="#(4)-%EC%97%AD%EC%A0%84%ED%8C%8C%EA%B8%B0%EB%B2%95%EC%9D%80-%EA%B3%BC%EC%A0%81%ED%95%A9%EC%9D%84-%EB%B0%A9%EC%A7%80%ED%95%98%EB%8A%94-%ED%85%8C%ED%81%AC%EB%8B%89%EC%A4%91-%ED%95%98%EB%82%98%EC%9D%B4%EB%8B%A4."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>O</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="(5)-순전파만-계산하고-싶을-경우-GPU메모리에-각-층의-계산결과를-저장할-필요가-없다.">
<a class="anchor" href="#(5)-%EC%88%9C%EC%A0%84%ED%8C%8C%EB%A7%8C-%EA%B3%84%EC%82%B0%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%84-%EA%B2%BD%EC%9A%B0-GPU%EB%A9%94%EB%AA%A8%EB%A6%AC%EC%97%90-%EA%B0%81-%EC%B8%B5%EC%9D%98-%EA%B3%84%EC%82%B0%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EC%A0%80%EC%9E%A5%ED%95%A0-%ED%95%84%EC%9A%94%EA%B0%80-%EC%97%86%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a><code>(5)</code> 순전파만 계산하고 싶을 경우 GPU메모리에 각 층의 계산결과를 저장할 필요가 없다.<a class="anchor-link" href="#(5)-%EC%88%9C%EC%A0%84%ED%8C%8C%EB%A7%8C-%EA%B3%84%EC%82%B0%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%84-%EA%B2%BD%EC%9A%B0-GPU%EB%A9%94%EB%AA%A8%EB%A6%AC%EC%97%90-%EA%B0%81-%EC%B8%B5%EC%9D%98-%EA%B3%84%EC%82%B0%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EC%A0%80%EC%9E%A5%ED%95%A0-%ED%95%84%EC%9A%94%EA%B0%80-%EC%97%86%EB%8B%A4."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>X</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/chch/big%20data%20analysis/2022/01/23/bd-final.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/chch/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/chch/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/chch/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/seoyeonc" target="_blank" title="seoyeonc"><svg class="svg-icon grey"><use xlink:href="/chch/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
