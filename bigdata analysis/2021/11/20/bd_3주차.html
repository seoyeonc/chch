<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>빅데이터 분석 (3주차) 9월28일 | Seoyeon Choi</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="빅데이터 분석 (3주차) 9월28일" />
<meta name="author" content="최서연" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="파이토치를 이용하여 회귀모형 학습하기 (2)" />
<meta property="og:description" content="파이토치를 이용하여 회귀모형 학습하기 (2)" />
<link rel="canonical" href="https://seoyeonc.github.io/chch/bigdata%20analysis/2021/11/20/bd_3%EC%A3%BC%EC%B0%A8.html" />
<meta property="og:url" content="https://seoyeonc.github.io/chch/bigdata%20analysis/2021/11/20/bd_3%EC%A3%BC%EC%B0%A8.html" />
<meta property="og:site_name" content="Seoyeon Choi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-20T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"파이토치를 이용하여 회귀모형 학습하기 (2)","url":"https://seoyeonc.github.io/chch/bigdata%20analysis/2021/11/20/bd_3%EC%A3%BC%EC%B0%A8.html","@type":"BlogPosting","headline":"빅데이터 분석 (3주차) 9월28일","dateModified":"2021-11-20T00:00:00-06:00","datePublished":"2021-11-20T00:00:00-06:00","author":{"@type":"Person","name":"최서연"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seoyeonc.github.io/chch/bigdata%20analysis/2021/11/20/bd_3%EC%A3%BC%EC%B0%A8.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/chch/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://seoyeonc.github.io/chch/feed.xml" title="Seoyeon Choi" /><link rel="shortcut icon" type="image/x-icon" href="/chch/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/chch/">Seoyeon Choi</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/chch/about/">About Me</a><a class="page-link" href="/chch/search/">Search</a><a class="page-link" href="/chch/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">빅데이터 분석 (3주차) 9월28일</h1><p class="page-description">파이토치를 이용하여 회귀모형 학습하기 (2)</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-11-20T00:00:00-06:00" itemprop="datePublished">
        Nov 20, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">최서연</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/chch/categories/#bigdata analysis">bigdata analysis</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/seoyeonc/chch/tree/master/_notebooks/2021-11-20-bd_3주차.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/chch/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/seoyeonc/chch/master?filepath=_notebooks%2F2021-11-20-bd_3%EC%A3%BC%EC%B0%A8.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chch/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/seoyeonc/chch/blob/master/_notebooks/2021-11-20-bd_3주차.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chch/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#Data">Data </a></li>
<li class="toc-entry toc-h3"><a href="#이전방법요약">이전방법요약 </a></li>
<li class="toc-entry toc-h3"><a href="#step1:-yhat">step1: yhat </a>
<ul>
<li class="toc-entry toc-h4"><a href="#방법1:-직접선언_직접-곱하는-것-(내가-공식을-알고-있어야-한다)">방법1: 직접선언_직접 곱하는 것 (내가 공식을 알고 있어야 한다) </a></li>
<li class="toc-entry toc-h4"><a href="#방법2:-torch.nn.Linear()-사용_우리가-주로-사용할-방법_Neural-Network">방법2: torch.nn.Linear() 사용_우리가 주로 사용할 방법_Neural Network </a></li>
<li class="toc-entry toc-h4"><a href="#방법3:-torch.nn.Linear()사용,-bias=True">방법3: torch.nn.Linear()사용, bias=True </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#step2:-loss">step2: loss </a>
<ul>
<li class="toc-entry toc-h4"><a href="#방법1:-손실함수를-직접정의하는-방법">방법1: 손실함수를 직접정의하는 방법 </a></li>
<li class="toc-entry toc-h4"><a href="#방법2:-torch.nn.MSELoss()를-사용하여-손실함수를-정의하는-방법">방법2: torch.nn.MSELoss()를 사용하여 손실함수를 정의하는 방법 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#숙제">숙제 </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-11-20-bd_3주차.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data">
<a class="anchor" href="#Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data<a class="anchor-link" href="#Data"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> model: $y_i= w_0+w_1 x_i +\epsilon_i = 2.5 + 4x_i +\epsilon_i, \quad i=1,2,\dots,n$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> model: ${\bf y}={\bf X}{\bf W} +\boldsymbol{\epsilon}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>${\bf y}=\begin{bmatrix} y_1 \\ y_2 \\ \dots \\ y_n\end{bmatrix}, \quad {\bf X}=\begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \dots \\ 1 &amp; x_n\end{bmatrix}, \quad {\bf W}=\begin{bmatrix} 2.5 \\ 4 \end{bmatrix}, \quad \boldsymbol{\epsilon}= \begin{bmatrix} \epsilon_1 \\ \dots \\ \epsilon_n\end{bmatrix}$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">202150754</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">100</span>
<span class="n">ones</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">X</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ones</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">W</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ϵ</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">0.4</span>
<span class="n">y</span><span class="o">=</span><span class="n">X</span><span class="nd">@W</span><span class="o">+</span><span class="n">ϵ</span>
<span class="n">ytrue</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@W</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 지난 시간에 했던 for문을 보고 step 찾기</p>
<div class="highlight"><pre><span></span><span class="n">What</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span> 
    <span class="n">Whats</span><span class="o">=</span><span class="n">Whats</span><span class="o">+</span><span class="p">[</span><span class="n">What</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span> 
    <span class="n">What</span><span class="o">.</span><span class="n">grad</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">yhat</span><span class="o">=</span><span class="n">X</span><span class="nd">@What</span> <span class="c1"># yhat을 계산하는 공식을 알고 있거나, 과정이 필요</span>
    <span class="n">yhats</span><span class="o">=</span><span class="n">yhats</span><span class="o">+</span><span class="p">[</span><span class="n">yhat</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># loss정의하는 과정이 필요!</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="n">losses</span> <span class="o">+</span> <span class="p">[</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span> <span class="c1"># 미분을 하는 과정이 필요</span>
    <span class="n">What</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">What</span><span class="o">.</span><span class="n">data</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">What</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span> <span class="c1"># 미분한 값을 가지고 업데이트를 하는 과정</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="이전방법요약">
<a class="anchor" href="#%EC%9D%B4%EC%A0%84%EB%B0%A9%EB%B2%95%EC%9A%94%EC%95%BD" aria-hidden="true"><span class="octicon octicon-link"></span></a>이전방법요약<a class="anchor-link" href="#%EC%9D%B4%EC%A0%84%EB%B0%A9%EB%B2%95%EC%9A%94%EC%95%BD"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> step1: yhat</p>
<p><code>-</code> step2: loss</p>
<p><code>-</code> step3: derivation</p>
<p><code>-</code> step4: update</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="step1:-yhat">
<a class="anchor" href="#step1:-yhat" aria-hidden="true"><span class="octicon octicon-link"></span></a>step1: yhat<a class="anchor-link" href="#step1:-yhat"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> feedforward 신경망을 설계하는 과정(딥러닝 용어!)</p>
<ul>
<li>입력층으로 데이터가 입력되고, 1개 이상으로 구성되는 은닉 층을 거쳐서 마지막에 있는 출력 층으로 출력 값을 내보내는 과정.</li>
<li>이전 틍에서 나온 출력 값이, 층과 층 사이에 적용되는 가중치 영향을 받은 다음 다음 층의 입력 값으로 들어가는 것</li>
</ul>
<p><code>-</code> 이 단계가 잘 완료되었다면, 임의의 ${\bf\hat{W}}$을 넣었을 때 $\bf\hat{y}$를 계산할 수 있어야 함</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="방법1:-직접선언_직접-곱하는-것-(내가-공식을-알고-있어야-한다)">
<a class="anchor" href="#%EB%B0%A9%EB%B2%951:-%EC%A7%81%EC%A0%91%EC%84%A0%EC%96%B8_%EC%A7%81%EC%A0%91-%EA%B3%B1%ED%95%98%EB%8A%94-%EA%B2%83-(%EB%82%B4%EA%B0%80-%EA%B3%B5%EC%8B%9D%EC%9D%84-%EC%95%8C%EA%B3%A0-%EC%9E%88%EC%96%B4%EC%95%BC-%ED%95%9C%EB%8B%A4)" aria-hidden="true"><span class="octicon octicon-link"></span></a>방법1: 직접선언_직접 곱하는 것 (내가 공식을 알고 있어야 한다)<a class="anchor-link" href="#%EB%B0%A9%EB%B2%951:-%EC%A7%81%EC%A0%91%EC%84%A0%EC%96%B8_%EC%A7%81%EC%A0%91-%EA%B3%B1%ED%95%98%EB%8A%94-%EA%B2%83-(%EB%82%B4%EA%B0%80-%EA%B3%B5%EC%8B%9D%EC%9D%84-%EC%95%8C%EA%B3%A0-%EC%9E%88%EC%96%B4%EC%95%BC-%ED%95%9C%EB%8B%A4)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> model: ${\bf y}={\bf X}{\bf W} +\boldsymbol{\epsilon}$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">What</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yhat1</span><span class="o">=</span><span class="n">X</span><span class="nd">@What</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yhat1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-27.9716, -26.0391, -25.8951, -24.1830, -23.6405, -23.1161, -22.0441,
        -21.9913, -21.4959, -21.2860, -20.4771, -19.6991, -19.1434, -18.0758,
        -17.5390, -17.4888, -16.8212, -16.6630, -16.2503, -14.3326, -13.8527,
        -13.6397, -13.5228, -13.2096, -12.8514, -12.8461, -12.7527, -12.2431,
        -12.0267, -11.7990, -11.6495, -11.5587, -11.5497, -11.1709, -10.9643,
        -10.7969, -10.7696, -10.7324, -10.6567, -10.4404, -10.1049,  -9.9527,
         -9.7916,  -9.3899,  -9.2762,  -8.2773,  -8.0850,  -7.9550,  -7.8498,
         -7.7767,  -7.6419,  -7.2295,  -7.1686,  -6.9773,  -6.9454,  -6.6435,
         -5.6597,  -5.5200,  -5.4562,  -5.3640,  -4.9588,  -4.9111,  -4.5447,
         -3.9894,  -3.6367,  -3.0762,  -2.4928,  -2.4512,  -2.1695,  -2.0062,
         -1.7060,   0.1909,   0.5915,   0.9467,   1.3453,   1.4359,   2.0752,
          2.4723,   2.5368,   2.7189,   2.7902,   2.8337,   3.2249,   3.7238,
          3.8636,   3.9170,   3.9852,   5.0601,   5.7496,   6.0569,   7.0621,
          7.2674,   7.6805,   7.9669,   8.4266,   9.6044,   9.6791,  10.7418,
         12.6324,  18.9507], grad_fn=&lt;MvBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="방법2:-torch.nn.Linear()-사용_우리가-주로-사용할-방법_Neural-Network">
<a class="anchor" href="#%EB%B0%A9%EB%B2%952:-torch.nn.Linear()-%EC%82%AC%EC%9A%A9_%EC%9A%B0%EB%A6%AC%EA%B0%80-%EC%A3%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%B0%A9%EB%B2%95_Neural-Network" aria-hidden="true"><span class="octicon octicon-link"></span></a>방법2: torch.nn.Linear() 사용_우리가 주로 사용할 방법_Neural Network<a class="anchor-link" href="#%EB%B0%A9%EB%B2%952:-torch.nn.Linear()-%EC%82%AC%EC%9A%A9_%EC%9A%B0%EB%A6%AC%EA%B0%80-%EC%A3%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%B0%A9%EB%B2%95_Neural-Network"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>? 두 번 입력하면 코드까지 다나온다~~</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>torch.nn.Linear<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Init signature:</span>
torch<span class="ansi-blue-fg">.</span>nn<span class="ansi-blue-fg">.</span>Linear<span class="ansi-blue-fg">(</span>
    in_features<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span>
    out_features<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span>
    bias<span class="ansi-blue-fg">:</span> bool <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span>
<span class="ansi-red-fg">Source:</span>        
<span class="ansi-green-fg">class</span> Linear<span class="ansi-blue-fg">(</span>Module<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">r"""Applies a linear transformation to the incoming data: :math:`y = xA^T + b`</span>

<span class="ansi-blue-fg">    This module supports :ref:`TensorFloat32&lt;tf32_on_ampere&gt;`.</span>

<span class="ansi-blue-fg">    Args:</span>
<span class="ansi-blue-fg">        in_features: size of each input sample</span>
<span class="ansi-blue-fg">        out_features: size of each output sample</span>
<span class="ansi-blue-fg">        bias: If set to ``False``, the layer will not learn an additive bias.</span>
<span class="ansi-blue-fg">            Default: ``True``</span>

<span class="ansi-blue-fg">    Shape:</span>
<span class="ansi-blue-fg">        - Input: :math:`(*, H_{in})` where :math:`*` means any number of</span>
<span class="ansi-blue-fg">          dimensions including none and :math:`H_{in} = \text{in\_features}`.</span>
<span class="ansi-blue-fg">        - Output: :math:`(*, H_{out})` where all but the last dimension</span>
<span class="ansi-blue-fg">          are the same shape as the input and :math:`H_{out} = \text{out\_features}`.</span>

<span class="ansi-blue-fg">    Attributes:</span>
<span class="ansi-blue-fg">        weight: the learnable weights of the module of shape</span>
<span class="ansi-blue-fg">            :math:`(\text{out\_features}, \text{in\_features})`. The values are</span>
<span class="ansi-blue-fg">            initialized from :math:`\mathcal{U}(-\sqrt{k}, \sqrt{k})`, where</span>
<span class="ansi-blue-fg">            :math:`k = \frac{1}{\text{in\_features}}`</span>
<span class="ansi-blue-fg">        bias:   the learnable bias of the module of shape :math:`(\text{out\_features})`.</span>
<span class="ansi-blue-fg">                If :attr:`bias` is ``True``, the values are initialized from</span>
<span class="ansi-blue-fg">                :math:`\mathcal{U}(-\sqrt{k}, \sqrt{k})` where</span>
<span class="ansi-blue-fg">                :math:`k = \frac{1}{\text{in\_features}}`</span>

<span class="ansi-blue-fg">    Examples::</span>

<span class="ansi-blue-fg">        &gt;&gt;&gt; m = nn.Linear(20, 30)</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; input = torch.randn(128, 20)</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; output = m(input)</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; print(output.size())</span>
<span class="ansi-blue-fg">        torch.Size([128, 30])</span>
<span class="ansi-blue-fg">    """</span>
    __constants__ <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'in_features'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'out_features'</span><span class="ansi-blue-fg">]</span>
    in_features<span class="ansi-blue-fg">:</span> int
    out_features<span class="ansi-blue-fg">:</span> int
    weight<span class="ansi-blue-fg">:</span> Tensor

    <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> in_features<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span> out_features<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span> bias<span class="ansi-blue-fg">:</span> bool <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
                 device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
        factory_kwargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">'device'</span><span class="ansi-blue-fg">:</span> device<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'dtype'</span><span class="ansi-blue-fg">:</span> dtype<span class="ansi-blue-fg">}</span>
        super<span class="ansi-blue-fg">(</span>Linear<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>in_features <span class="ansi-blue-fg">=</span> in_features
        self<span class="ansi-blue-fg">.</span>out_features <span class="ansi-blue-fg">=</span> out_features
        self<span class="ansi-blue-fg">.</span>weight <span class="ansi-blue-fg">=</span> Parameter<span class="ansi-blue-fg">(</span>torch<span class="ansi-blue-fg">.</span>empty<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>out_features<span class="ansi-blue-fg">,</span> in_features<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>factory_kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">if</span> bias<span class="ansi-blue-fg">:</span>
            self<span class="ansi-blue-fg">.</span>bias <span class="ansi-blue-fg">=</span> Parameter<span class="ansi-blue-fg">(</span>torch<span class="ansi-blue-fg">.</span>empty<span class="ansi-blue-fg">(</span>out_features<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>factory_kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
            self<span class="ansi-blue-fg">.</span>register_parameter<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'bias'</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>reset_parameters<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

    <span class="ansi-green-fg">def</span> reset_parameters<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
        <span class="ansi-red-fg"># Setting a=sqrt(5) in kaiming_uniform is the same as initializing with</span>
        <span class="ansi-red-fg"># uniform(-1/sqrt(in_features), 1/sqrt(in_features)). For details, see</span>
        <span class="ansi-red-fg"># https://github.com/pytorch/pytorch/issues/57109</span>
        init<span class="ansi-blue-fg">.</span>kaiming_uniform_<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>weight<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">=</span>math<span class="ansi-blue-fg">.</span>sqrt<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>bias <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
            fan_in<span class="ansi-blue-fg">,</span> _ <span class="ansi-blue-fg">=</span> init<span class="ansi-blue-fg">.</span>_calculate_fan_in_and_fan_out<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>weight<span class="ansi-blue-fg">)</span>
            bound <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span> <span class="ansi-blue-fg">/</span> math<span class="ansi-blue-fg">.</span>sqrt<span class="ansi-blue-fg">(</span>fan_in<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> fan_in <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0</span> <span class="ansi-green-fg">else</span> <span class="ansi-cyan-fg">0</span>
            init<span class="ansi-blue-fg">.</span>uniform_<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>bias<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">-</span>bound<span class="ansi-blue-fg">,</span> bound<span class="ansi-blue-fg">)</span>

    <span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">:</span> Tensor<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> Tensor<span class="ansi-blue-fg">:</span>
        <span class="ansi-green-fg">return</span> F<span class="ansi-blue-fg">.</span>linear<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>weight<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>bias<span class="ansi-blue-fg">)</span>

    <span class="ansi-green-fg">def</span> extra_repr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> str<span class="ansi-blue-fg">:</span>
        <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">'in_features={}, out_features={}, bias={}'</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>
            self<span class="ansi-blue-fg">.</span>in_features<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>out_features<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>bias <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span>
        <span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>           ~/anaconda3/envs/csy/lib/python3.8/site-packages/torch/nn/modules/linear.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>     NonDynamicallyQuantizableLinear, LazyLinear, Linear, Linear
</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>${\bf y}=\begin{bmatrix} y_1 \\ y_2 \\ \dots \\ y_n\end{bmatrix}, \quad {\bf X}=\begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \dots \\ 1 &amp; x_n\end{bmatrix}, \quad {\bf W}=\begin{bmatrix} 2.5 \\ 4 \end{bmatrix}, \quad \boldsymbol{\epsilon}= \begin{bmatrix} \epsilon_1 \\ \dots \\ \epsilon_n\end{bmatrix}$</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">out_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>in_features – size of each input sample</li>
<li>out_features – size of each output sample</li>
<li>bias – If set to False, the layer will not learn an additive bias. Default: True</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Linear라는 클래스를 사용하여, in_features입력차원이자 $X(1,x_i)$라서 2, out<em>features출력차원이자 $y</em>{hat}$라서 1</li>
<li>bias가 False 인 이유는 $X(1,x_i)$에서 1이 bias의 역할을 하고 있기 때문에 필요가 없어서</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span> <span class="c1"># 우리가 원하는 입력값이 아니야</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-0.1629,  0.6929]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-5., 10.]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-27.9716],
        [-26.0391],
        [-25.8951],
        [-24.1830],
        [-23.6405],
        [-23.1161],
        [-22.0441],
        [-21.9913],
        [-21.4959],
        [-21.2860],
        [-20.4771],
        [-19.6991],
        [-19.1434],
        [-18.0758],
        [-17.5390],
        [-17.4888],
        [-16.8212],
        [-16.6630],
        [-16.2503],
        [-14.3326],
        [-13.8527],
        [-13.6397],
        [-13.5228],
        [-13.2096],
        [-12.8514],
        [-12.8461],
        [-12.7527],
        [-12.2431],
        [-12.0267],
        [-11.7990],
        [-11.6495],
        [-11.5587],
        [-11.5497],
        [-11.1709],
        [-10.9643],
        [-10.7969],
        [-10.7696],
        [-10.7324],
        [-10.6567],
        [-10.4404],
        [-10.1049],
        [ -9.9527],
        [ -9.7916],
        [ -9.3899],
        [ -9.2762],
        [ -8.2773],
        [ -8.0850],
        [ -7.9550],
        [ -7.8498],
        [ -7.7767],
        [ -7.6419],
        [ -7.2295],
        [ -7.1686],
        [ -6.9773],
        [ -6.9454],
        [ -6.6435],
        [ -5.6597],
        [ -5.5200],
        [ -5.4562],
        [ -5.3640],
        [ -4.9588],
        [ -4.9111],
        [ -4.5447],
        [ -3.9894],
        [ -3.6367],
        [ -3.0762],
        [ -2.4928],
        [ -2.4512],
        [ -2.1695],
        [ -2.0062],
        [ -1.7060],
        [  0.1909],
        [  0.5915],
        [  0.9467],
        [  1.3453],
        [  1.4359],
        [  2.0752],
        [  2.4723],
        [  2.5368],
        [  2.7189],
        [  2.7902],
        [  2.8337],
        [  3.2249],
        [  3.7238],
        [  3.8636],
        [  3.9170],
        [  3.9852],
        [  5.0601],
        [  5.7496],
        [  6.0569],
        [  7.0621],
        [  7.2674],
        [  7.6805],
        [  7.9669],
        [  8.4266],
        [  9.6044],
        [  9.6791],
        [ 10.7418],
        [ 12.6324],
        [ 18.9507]], grad_fn=&lt;MmBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yhat2</span><span class="o">=</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>네트워크에 X를 입력으로 넣음으로써 y를 구하는 법</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="방법3:-torch.nn.Linear()사용,-bias=True">
<a class="anchor" href="#%EB%B0%A9%EB%B2%953:-torch.nn.Linear()%EC%82%AC%EC%9A%A9,-bias=True" aria-hidden="true"><span class="octicon octicon-link"></span></a>방법3: torch.nn.Linear()사용, bias=True<a class="anchor-link" href="#%EB%B0%A9%EB%B2%953:-torch.nn.Linear()%EC%82%AC%EC%9A%A9,-bias=True"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> model: $y_i= w_0+w_1 x_i +\epsilon_i = 2.5 + 4x_i +\epsilon_i, \quad i=1,2,\dots,n$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">out_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Linear라는 클래스를 사용하여, in_features입력차원이자 $x_i$라서 1, out<em>features출력차원이자 $y</em>{hat}$라서 1</li>
<li>bias가 True 인 이유는 bias term상수항이 존재하는 네트워크라 정의했기 때문</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span> <span class="c1"># 입력차원을 1로 했기 때문에 출력차원 1개만 값이 나온 것.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-0.9442]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">]])</span> <span class="c1"># tensor 괄호 수 따라가..</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span><span class="n">net</span><span class="o">.</span><span class="n">bias</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Parameter containing:
 tensor([[10.]], requires_grad=True),
 Parameter containing:
 tensor([-5.], requires_grad=True))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>$X$가 아니라 $x(즉, x_i)$를 넣어야 함</li>
<li>net(x.reshape(100,1)) x.reshape은 100값이 나오지만, (100,1)로 차원 명시 해주기</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-27.9716],
        [-26.0391],
        [-25.8951],
        [-24.1830],
        [-23.6405],
        [-23.1161],
        [-22.0441],
        [-21.9913],
        [-21.4959],
        [-21.2860],
        [-20.4771],
        [-19.6991],
        [-19.1434],
        [-18.0758],
        [-17.5390],
        [-17.4888],
        [-16.8212],
        [-16.6630],
        [-16.2503],
        [-14.3326],
        [-13.8527],
        [-13.6397],
        [-13.5228],
        [-13.2096],
        [-12.8514],
        [-12.8461],
        [-12.7527],
        [-12.2431],
        [-12.0267],
        [-11.7990],
        [-11.6495],
        [-11.5587],
        [-11.5497],
        [-11.1709],
        [-10.9643],
        [-10.7969],
        [-10.7696],
        [-10.7324],
        [-10.6567],
        [-10.4404],
        [-10.1049],
        [ -9.9527],
        [ -9.7916],
        [ -9.3899],
        [ -9.2762],
        [ -8.2773],
        [ -8.0850],
        [ -7.9550],
        [ -7.8498],
        [ -7.7767],
        [ -7.6419],
        [ -7.2295],
        [ -7.1686],
        [ -6.9773],
        [ -6.9454],
        [ -6.6435],
        [ -5.6597],
        [ -5.5200],
        [ -5.4562],
        [ -5.3640],
        [ -4.9588],
        [ -4.9111],
        [ -4.5447],
        [ -3.9894],
        [ -3.6367],
        [ -3.0762],
        [ -2.4928],
        [ -2.4512],
        [ -2.1695],
        [ -2.0062],
        [ -1.7060],
        [  0.1909],
        [  0.5915],
        [  0.9467],
        [  1.3453],
        [  1.4359],
        [  2.0752],
        [  2.4723],
        [  2.5368],
        [  2.7189],
        [  2.7902],
        [  2.8337],
        [  3.2249],
        [  3.7238],
        [  3.8636],
        [  3.9170],
        [  3.9852],
        [  5.0601],
        [  5.7496],
        [  6.0569],
        [  7.0621],
        [  7.2674],
        [  7.6805],
        [  7.9669],
        [  8.4266],
        [  9.6044],
        [  9.6791],
        [ 10.7418],
        [ 12.6324],
        [ 18.9507]], grad_fn=&lt;AddmmBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>방법 2와 3의 결과가 같아서 방법 3의 yhat은 따로 변수화하지 않음</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="step2:-loss">
<a class="anchor" href="#step2:-loss" aria-hidden="true"><span class="octicon octicon-link"></span></a>step2: loss<a class="anchor-link" href="#step2:-loss"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="방법1:-손실함수를-직접정의하는-방법">
<a class="anchor" href="#%EB%B0%A9%EB%B2%951:-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EB%A5%BC-%EC%A7%81%EC%A0%91%EC%A0%95%EC%9D%98%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>방법1: 손실함수를 직접정의하는 방법<a class="anchor-link" href="#%EB%B0%A9%EB%B2%951:-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EB%A5%BC-%EC%A7%81%EC%A0%91%EC%A0%95%EC%9D%98%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(109.8145, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(187.0950, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>두 값이 다르기도 하고, 187.0950는 잘못된 결과</li>
<li>grad_fn=<meanbackward0> 주의깊게 보기&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([100, 100])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([100])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yhat2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([100, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>차원에 대한 개념 파악 너무 중요$\star$</strong></li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat2</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># yhat2를 벡터화시키는 방법 1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(109.8145, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">yhat2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># y의 dhape을 바꿔주는 방법 2</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(109.8145, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="방법2:-torch.nn.MSELoss()를-사용하여-손실함수를-정의하는-방법">
<a class="anchor" href="#%EB%B0%A9%EB%B2%952:-torch.nn.MSELoss()%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EB%A5%BC-%EC%A0%95%EC%9D%98%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>방법2: torch.nn.MSELoss()를 사용하여 손실함수를 정의하는 방법<a class="anchor-link" href="#%EB%B0%A9%EB%B2%952:-torch.nn.MSELoss()%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EB%A5%BC-%EC%A0%95%EC%9D%98%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>torch.nn.MSELoss는 class함수</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>torch.nn.MSELoss<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Init signature:</span> torch<span class="ansi-blue-fg">.</span>nn<span class="ansi-blue-fg">.</span>MSELoss<span class="ansi-blue-fg">(</span>size_average<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> reduce<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> reduction<span class="ansi-blue-fg">:</span> str <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'mean'</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span>
<span class="ansi-red-fg">Source:</span>        
<span class="ansi-green-fg">class</span> MSELoss<span class="ansi-blue-fg">(</span>_Loss<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">r"""Creates a criterion that measures the mean squared error (squared L2 norm) between</span>
<span class="ansi-blue-fg">    each element in the input :math:`x` and target :math:`y`.</span>

<span class="ansi-blue-fg">    The unreduced (i.e. with :attr:`reduction` set to ``'none'``) loss can be described as:</span>

<span class="ansi-blue-fg">    .. math::</span>
<span class="ansi-blue-fg">        \ell(x, y) = L = \{l_1,\dots,l_N\}^\top, \quad</span>
<span class="ansi-blue-fg">        l_n = \left( x_n - y_n \right)^2,</span>

<span class="ansi-blue-fg">    where :math:`N` is the batch size. If :attr:`reduction` is not ``'none'``</span>
<span class="ansi-blue-fg">    (default ``'mean'``), then:</span>

<span class="ansi-blue-fg">    .. math::</span>
<span class="ansi-blue-fg">        \ell(x, y) =</span>
<span class="ansi-blue-fg">        \begin{cases}</span>
<span class="ansi-blue-fg">            \operatorname{mean}(L), &amp;  \text{if reduction} = \text{`mean';}\\</span>
<span class="ansi-blue-fg">            \operatorname{sum}(L),  &amp;  \text{if reduction} = \text{`sum'.}</span>
<span class="ansi-blue-fg">        \end{cases}</span>

<span class="ansi-blue-fg">    :math:`x` and :math:`y` are tensors of arbitrary shapes with a total</span>
<span class="ansi-blue-fg">    of :math:`n` elements each.</span>

<span class="ansi-blue-fg">    The mean operation still operates over all the elements, and divides by :math:`n`.</span>

<span class="ansi-blue-fg">    The division by :math:`n` can be avoided if one sets ``reduction = 'sum'``.</span>

<span class="ansi-blue-fg">    Args:</span>
<span class="ansi-blue-fg">        size_average (bool, optional): Deprecated (see :attr:`reduction`). By default,</span>
<span class="ansi-blue-fg">            the losses are averaged over each loss element in the batch. Note that for</span>
<span class="ansi-blue-fg">            some losses, there are multiple elements per sample. If the field :attr:`size_average`</span>
<span class="ansi-blue-fg">            is set to ``False``, the losses are instead summed for each minibatch. Ignored</span>
<span class="ansi-blue-fg">            when :attr:`reduce` is ``False``. Default: ``True``</span>
<span class="ansi-blue-fg">        reduce (bool, optional): Deprecated (see :attr:`reduction`). By default, the</span>
<span class="ansi-blue-fg">            losses are averaged or summed over observations for each minibatch depending</span>
<span class="ansi-blue-fg">            on :attr:`size_average`. When :attr:`reduce` is ``False``, returns a loss per</span>
<span class="ansi-blue-fg">            batch element instead and ignores :attr:`size_average`. Default: ``True``</span>
<span class="ansi-blue-fg">        reduction (string, optional): Specifies the reduction to apply to the output:</span>
<span class="ansi-blue-fg">            ``'none'`` | ``'mean'`` | ``'sum'``. ``'none'``: no reduction will be applied,</span>
<span class="ansi-blue-fg">            ``'mean'``: the sum of the output will be divided by the number of</span>
<span class="ansi-blue-fg">            elements in the output, ``'sum'``: the output will be summed. Note: :attr:`size_average`</span>
<span class="ansi-blue-fg">            and :attr:`reduce` are in the process of being deprecated, and in the meantime,</span>
<span class="ansi-blue-fg">            specifying either of those two args will override :attr:`reduction`. Default: ``'mean'``</span>

<span class="ansi-blue-fg">    Shape:</span>
<span class="ansi-blue-fg">        - Input: :math:`(*)`, where :math:`*` means any number of dimensions.</span>
<span class="ansi-blue-fg">        - Target: :math:`(*)`, same shape as the input.</span>

<span class="ansi-blue-fg">    Examples::</span>

<span class="ansi-blue-fg">        &gt;&gt;&gt; loss = nn.MSELoss()</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; input = torch.randn(3, 5, requires_grad=True)</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; target = torch.randn(3, 5)</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; output = loss(input, target)</span>
<span class="ansi-blue-fg">        &gt;&gt;&gt; output.backward()</span>
<span class="ansi-blue-fg">    """</span>
    __constants__ <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'reduction'</span><span class="ansi-blue-fg">]</span>

    <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> size_average<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> reduce<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> reduction<span class="ansi-blue-fg">:</span> str <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'mean'</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
        super<span class="ansi-blue-fg">(</span>MSELoss<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>size_average<span class="ansi-blue-fg">,</span> reduce<span class="ansi-blue-fg">,</span> reduction<span class="ansi-blue-fg">)</span>

    <span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">:</span> Tensor<span class="ansi-blue-fg">,</span> target<span class="ansi-blue-fg">:</span> Tensor<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> Tensor<span class="ansi-blue-fg">:</span>
        <span class="ansi-green-fg">return</span> F<span class="ansi-blue-fg">.</span>mse_loss<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">,</span> target<span class="ansi-blue-fg">,</span> reduction<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>reduction<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>           ~/anaconda3/envs/csy/lib/python3.8/site-packages/torch/nn/modules/loss.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>     
</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>definition of torch.nn.MSELoss</p>
<ul>
<li>Creates a criterion that measures the mean squared error (squared L2 norm) between each element in the input $xx$ and target $yy$.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lossfn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span> <span class="c1"># 단지 입력만하면 loss function이 만들어짐</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">lossfn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat1</span><span class="p">)</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(109.8145, grad_fn=&lt;MseLossBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">lossfn</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">yhat2</span><span class="p">)</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(109.8145, grad_fn=&lt;MseLossBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>미분 꼬리표 붙은 모습! grad_fn=<mselossbackward0>&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>총 6가지 조합으로 loss를 구할 수 있다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="숙제">
<a class="anchor" href="#%EC%88%99%EC%A0%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://ieilms.jbnu.ac.kr/">숙제</a><a class="anchor-link" href="#%EC%88%99%EC%A0%9C"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> model: $y_i= w_0+w_1 x_{i1}+w_2 x_{i2} +\epsilon_i = 2.5 + 4x_{1i} + -2x_{2i}+\epsilon_i, \quad i=1,2,\dots,n$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">202150754</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">100</span>
<span class="n">ones</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x1</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">x2</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">X</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ones</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">W</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">])</span>
<span class="n">ϵ</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span><span class="o">=</span><span class="n">X</span><span class="nd">@W</span><span class="o">+</span><span class="n">ϵ</span>
<span class="n">ytrue</span><span class="o">=</span><span class="n">X</span><span class="nd">@W</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">out_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.1152, 0.4159, 0.3233]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 2.5000,  5.0000, -2.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-2.6509],
        [-3.6075],
        [-3.5596],
        [-3.1381],
        [-3.3609],
        [-3.4499],
        [-3.2561],
        [-3.2889],
        [-3.2011],
        [-3.1503],
        [-2.7970],
        [-2.5058],
        [-2.3969],
        [-1.9746],
        [-1.7134],
        [-1.6971],
        [-1.4055],
        [-1.5425],
        [-1.4787],
        [-0.5325],
        [-0.5519],
        [-0.4983],
        [-0.5579],
        [-0.4252],
        [-0.3783],
        [-0.3975],
        [-0.4601],
        [-0.3162],
        [-0.2366],
        [-0.1835],
        [-0.1374],
        [-0.1168],
        [-0.1915],
        [-0.2164],
        [-0.1212],
        [-0.0441],
        [-0.0724],
        [-0.0834],
        [-0.0505],
        [-0.0193],
        [ 0.1136],
        [ 0.1171],
        [ 0.1026],
        [ 0.2901],
        [ 0.2309],
        [ 0.7120],
        [ 0.7832],
        [ 0.8135],
        [ 0.7912],
        [ 0.7812],
        [ 0.8180],
        [ 0.9363],
        [ 0.9441],
        [ 1.0259],
        [ 1.0002],
        [ 1.0770],
        [ 1.4815],
        [ 1.3693],
        [ 1.3779],
        [ 1.4225],
        [ 1.6098],
        [ 1.5941],
        [ 1.7537],
        [ 2.0001],
        [ 2.0957],
        [ 2.3735],
        [ 2.6115],
        [ 2.6187],
        [ 2.7009],
        [ 2.7603],
        [ 2.8919],
        [ 3.7759],
        [ 3.9732],
        [ 4.0655],
        [ 4.2620],
        [ 4.2635],
        [ 4.4946],
        [ 4.6567],
        [ 4.6651],
        [ 4.7379],
        [ 4.7674],
        [ 4.6795],
        [ 4.8486],
        [ 5.0364],
        [ 5.0838],
        [ 5.0771],
        [ 5.0922],
        [ 5.5662],
        [ 5.8656],
        [ 5.8907],
        [ 6.3554],
        [ 6.4389],
        [ 6.4179],
        [ 6.2463],
        [ 6.2930],
        [ 6.6489],
        [ 6.0923],
        [ 6.1693],
        [ 6.9698],
        [ 9.9439]], grad_fn=&lt;MmBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yhat</span><span class="o">=</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lossfn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">=</span><span class="n">lossfn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(24.9339, grad_fn=&lt;MseLossBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

&lt;/div&gt;
 

</mselossbackward0>
</li>
</ul>
</div>
</div></div></meanbackward0>
</li>
</ul>
</div>
</div></div>
</div>


  </div><a class="u-url" href="/chch/bigdata%20analysis/2021/11/20/bd_3%EC%A3%BC%EC%B0%A8.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/chch/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/chch/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/chch/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/seoyeonc" title="seoyeonc"><svg class="svg-icon grey"><use xlink:href="/chch/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
